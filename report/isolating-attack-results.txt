Dataset: train-50000, test-10000
[fed-epoch 1] cid: 0
Train on 10000 samples, validate on 10000 samples
Using learning rate 0.0001
Epoch 1/15
10000/10000 [==============================] - 9s 898us/sample - loss: 2.1574 - accuracy: 0.1773 - val_loss: 1.9840 - val_accuracy: 0.2408
Using learning rate 0.0001
Epoch 2/15
10000/10000 [==============================] - 8s 809us/sample - loss: 1.9286 - accuracy: 0.2507 - val_loss: 1.8967 - val_accuracy: 0.2670
Using learning rate 0.0001
Epoch 3/15
10000/10000 [==============================] - 8s 808us/sample - loss: 1.8339 - accuracy: 0.2902 - val_loss: 1.7896 - val_accuracy: 0.3196
Using learning rate 0.0001
Epoch 4/15
10000/10000 [==============================] - 8s 809us/sample - loss: 1.7737 - accuracy: 0.3238 - val_loss: 1.7537 - val_accuracy: 0.3445
Using learning rate 0.0001
Epoch 5/15
10000/10000 [==============================] - 8s 808us/sample - loss: 1.6932 - accuracy: 0.3585 - val_loss: 1.6749 - val_accuracy: 0.3589
Using learning rate 0.0001
Epoch 6/15
10000/10000 [==============================] - 8s 807us/sample - loss: 1.6088 - accuracy: 0.3973 - val_loss: 1.5898 - val_accuracy: 0.4134
Using learning rate 0.0001
Epoch 7/15
10000/10000 [==============================] - 8s 808us/sample - loss: 1.5349 - accuracy: 0.4353 - val_loss: 1.5834 - val_accuracy: 0.4204
Using learning rate 0.0001
Epoch 8/15
10000/10000 [==============================] - 8s 810us/sample - loss: 1.4718 - accuracy: 0.4710 - val_loss: 1.5102 - val_accuracy: 0.4562
Using learning rate 0.0001
Epoch 9/15
10000/10000 [==============================] - 8s 808us/sample - loss: 1.4015 - accuracy: 0.4982 - val_loss: 1.5458 - val_accuracy: 0.4597
Using learning rate 0.0001
Epoch 10/15
10000/10000 [==============================] - 8s 807us/sample - loss: 1.3411 - accuracy: 0.5262 - val_loss: 1.4596 - val_accuracy: 0.4917
Using learning rate 0.0001
Epoch 11/15
10000/10000 [==============================] - 8s 808us/sample - loss: 1.2962 - accuracy: 0.5399 - val_loss: 1.4357 - val_accuracy: 0.4928
Using learning rate 0.0001
Epoch 12/15
10000/10000 [==============================] - 8s 807us/sample - loss: 1.2326 - accuracy: 0.5690 - val_loss: 1.5174 - val_accuracy: 0.4927
Using learning rate 0.0001
Epoch 13/15
10000/10000 [==============================] - 8s 808us/sample - loss: 1.1792 - accuracy: 0.5953 - val_loss: 1.4707 - val_accuracy: 0.5014
Using learning rate 0.0001
Epoch 14/15
10000/10000 [==============================] - 8s 808us/sample - loss: 1.1123 - accuracy: 0.6121 - val_loss: 1.4990 - val_accuracy: 0.5016
Using learning rate 0.0001
Epoch 15/15
10000/10000 [==============================] - 8s 808us/sample - loss: 1.0656 - accuracy: 0.6339 - val_loss: 1.4469 - val_accuracy: 0.5215
[fed-epoch 1] cid: 1
Train on 10000 samples, validate on 10000 samples
Using learning rate 0.0001
Epoch 1/15
10000/10000 [==============================] - 9s 876us/sample - loss: 2.1111 - accuracy: 0.1624 - val_loss: 1.9863 - val_accuracy: 0.1842
Using learning rate 0.0001
Epoch 2/15
10000/10000 [==============================] - 8s 806us/sample - loss: 1.9761 - accuracy: 0.1832 - val_loss: 1.9497 - val_accuracy: 0.1928
Using learning rate 0.0001
Epoch 3/15
10000/10000 [==============================] - 8s 806us/sample - loss: 1.9204 - accuracy: 0.2196 - val_loss: 1.8750 - val_accuracy: 0.2571
Using learning rate 0.0001
Epoch 4/15
10000/10000 [==============================] - 8s 805us/sample - loss: 1.8005 - accuracy: 0.2951 - val_loss: 1.7906 - val_accuracy: 0.2931
Using learning rate 0.0001
Epoch 5/15
10000/10000 [==============================] - 8s 805us/sample - loss: 1.7214 - accuracy: 0.3328 - val_loss: 1.7218 - val_accuracy: 0.3282
Using learning rate 0.0001
Epoch 6/15
10000/10000 [==============================] - 8s 805us/sample - loss: 1.6399 - accuracy: 0.3725 - val_loss: 1.6623 - val_accuracy: 0.3825
Using learning rate 0.0001
Epoch 7/15
10000/10000 [==============================] - 8s 806us/sample - loss: 1.5794 - accuracy: 0.3979 - val_loss: 1.6539 - val_accuracy: 0.3884
Using learning rate 0.0001
Epoch 8/15
10000/10000 [==============================] - 8s 806us/sample - loss: 1.5147 - accuracy: 0.4264 - val_loss: 1.5740 - val_accuracy: 0.4251
Using learning rate 0.0001
Epoch 9/15
10000/10000 [==============================] - 8s 806us/sample - loss: 1.4678 - accuracy: 0.4546 - val_loss: 1.5498 - val_accuracy: 0.4301
Using learning rate 0.0001
Epoch 10/15
10000/10000 [==============================] - 8s 805us/sample - loss: 1.4071 - accuracy: 0.4783 - val_loss: 1.5501 - val_accuracy: 0.4476
Using learning rate 0.0001
Epoch 11/15
10000/10000 [==============================] - 8s 805us/sample - loss: 1.3419 - accuracy: 0.5089 - val_loss: 1.5236 - val_accuracy: 0.4586
Using learning rate 0.0001
Epoch 12/15
10000/10000 [==============================] - 8s 804us/sample - loss: 1.2854 - accuracy: 0.5289 - val_loss: 1.5783 - val_accuracy: 0.4458
Using learning rate 0.0001
Epoch 13/15
10000/10000 [==============================] - 8s 806us/sample - loss: 1.2344 - accuracy: 0.5534 - val_loss: 1.5125 - val_accuracy: 0.4656
Using learning rate 0.0001
Epoch 14/15
10000/10000 [==============================] - 8s 805us/sample - loss: 1.1734 - accuracy: 0.5791 - val_loss: 1.5156 - val_accuracy: 0.4837
Using learning rate 0.0001
Epoch 15/15
10000/10000 [==============================] - 8s 803us/sample - loss: 1.1262 - accuracy: 0.6013 - val_loss: 1.4969 - val_accuracy: 0.4848
[fed-epoch 1] cid: 2
Train on 10000 samples, validate on 10000 samples
Using learning rate 0.0001
Epoch 1/15
10000/10000 [==============================] - 9s 882us/sample - loss: 2.0988 - accuracy: 0.1795 - val_loss: 1.9446 - val_accuracy: 0.2609
Using learning rate 0.0001
Epoch 2/15
10000/10000 [==============================] - 8s 809us/sample - loss: 1.8474 - accuracy: 0.2754 - val_loss: 1.8023 - val_accuracy: 0.2974
Using learning rate 0.0001
Epoch 3/15
10000/10000 [==============================] - 8s 809us/sample - loss: 1.7549 - accuracy: 0.3168 - val_loss: 1.7260 - val_accuracy: 0.3401
Using learning rate 0.0001
Epoch 4/15
10000/10000 [==============================] - 8s 810us/sample - loss: 1.6731 - accuracy: 0.3670 - val_loss: 1.6745 - val_accuracy: 0.3901
Using learning rate 0.0001
Epoch 5/15
10000/10000 [==============================] - 8s 808us/sample - loss: 1.6078 - accuracy: 0.4112 - val_loss: 1.5998 - val_accuracy: 0.4172
Using learning rate 0.0001
Epoch 6/15
10000/10000 [==============================] - 8s 810us/sample - loss: 1.5451 - accuracy: 0.4275 - val_loss: 1.5748 - val_accuracy: 0.4328
Using learning rate 0.0001
Epoch 7/15
10000/10000 [==============================] - 8s 809us/sample - loss: 1.4872 - accuracy: 0.4561 - val_loss: 1.5746 - val_accuracy: 0.4242
Using learning rate 0.0001
Epoch 8/15
10000/10000 [==============================] - 8s 808us/sample - loss: 1.4256 - accuracy: 0.4835 - val_loss: 1.5457 - val_accuracy: 0.4518
Using learning rate 0.0001
Epoch 9/15
10000/10000 [==============================] - 8s 810us/sample - loss: 1.3724 - accuracy: 0.5062 - val_loss: 1.5087 - val_accuracy: 0.4694
Using learning rate 0.0001
Epoch 10/15
10000/10000 [==============================] - 8s 810us/sample - loss: 1.3149 - accuracy: 0.5241 - val_loss: 1.4703 - val_accuracy: 0.4809
Using learning rate 0.0001
Epoch 11/15
10000/10000 [==============================] - 8s 809us/sample - loss: 1.2559 - accuracy: 0.5586 - val_loss: 1.4991 - val_accuracy: 0.4842
Using learning rate 0.0001
Epoch 12/15
10000/10000 [==============================] - 8s 809us/sample - loss: 1.2062 - accuracy: 0.5774 - val_loss: 1.5361 - val_accuracy: 0.4872
Using learning rate 0.0001
Epoch 13/15
10000/10000 [==============================] - 8s 809us/sample - loss: 1.1580 - accuracy: 0.5957 - val_loss: 1.4732 - val_accuracy: 0.5058
Using learning rate 0.0001
Epoch 14/15
10000/10000 [==============================] - 8s 810us/sample - loss: 1.0857 - accuracy: 0.6286 - val_loss: 1.5442 - val_accuracy: 0.4924
Using learning rate 0.0001
Epoch 15/15
10000/10000 [==============================] - 8s 807us/sample - loss: 1.0374 - accuracy: 0.6473 - val_loss: 1.5303 - val_accuracy: 0.5141
[fed-epoch 1] cid: 3
Train on 10000 samples, validate on 10000 samples
Using learning rate 0.0001
Epoch 1/15
10000/10000 [==============================] - 9s 883us/sample - loss: 2.2331 - accuracy: 0.1430 - val_loss: 2.0168 - val_accuracy: 0.1943
Using learning rate 0.0001
Epoch 2/15
10000/10000 [==============================] - 8s 804us/sample - loss: 2.0078 - accuracy: 0.1902 - val_loss: 1.9512 - val_accuracy: 0.2080
Using learning rate 0.0001
Epoch 3/15
10000/10000 [==============================] - 8s 803us/sample - loss: 1.9441 - accuracy: 0.2245 - val_loss: 1.9015 - val_accuracy: 0.2482
Using learning rate 0.0001
Epoch 4/15
10000/10000 [==============================] - 8s 804us/sample - loss: 1.8897 - accuracy: 0.2485 - val_loss: 1.8374 - val_accuracy: 0.2697
Using learning rate 0.0001
Epoch 5/15
10000/10000 [==============================] - 8s 805us/sample - loss: 1.8201 - accuracy: 0.2877 - val_loss: 1.7792 - val_accuracy: 0.3030
Using learning rate 0.0001
Epoch 6/15
10000/10000 [==============================] - 8s 805us/sample - loss: 1.7720 - accuracy: 0.3059 - val_loss: 1.7475 - val_accuracy: 0.3191
Using learning rate 0.0001
Epoch 7/15
10000/10000 [==============================] - 8s 803us/sample - loss: 1.7302 - accuracy: 0.3264 - val_loss: 1.7298 - val_accuracy: 0.3372
Using learning rate 0.0001
Epoch 8/15
10000/10000 [==============================] - 8s 804us/sample - loss: 1.6910 - accuracy: 0.3394 - val_loss: 1.7152 - val_accuracy: 0.3382
Using learning rate 0.0001
Epoch 9/15
10000/10000 [==============================] - 8s 803us/sample - loss: 1.6613 - accuracy: 0.3582 - val_loss: 1.7179 - val_accuracy: 0.3352
Using learning rate 0.0001
Epoch 10/15
10000/10000 [==============================] - 8s 804us/sample - loss: 1.6232 - accuracy: 0.3731 - val_loss: 1.6888 - val_accuracy: 0.3536
Using learning rate 0.0001
Epoch 11/15
10000/10000 [==============================] - 8s 805us/sample - loss: 1.5990 - accuracy: 0.3841 - val_loss: 1.6238 - val_accuracy: 0.3848
Using learning rate 0.0001
Epoch 12/15
10000/10000 [==============================] - 8s 803us/sample - loss: 1.5666 - accuracy: 0.4010 - val_loss: 1.6043 - val_accuracy: 0.3951
Using learning rate 0.0001
Epoch 13/15
10000/10000 [==============================] - 8s 804us/sample - loss: 1.5194 - accuracy: 0.4281 - val_loss: 1.5825 - val_accuracy: 0.4116
Using learning rate 0.0001
Epoch 14/15
10000/10000 [==============================] - 8s 805us/sample - loss: 1.4925 - accuracy: 0.4353 - val_loss: 1.5963 - val_accuracy: 0.4014
Using learning rate 0.0001
Epoch 15/15
10000/10000 [==============================] - 8s 804us/sample - loss: 1.4720 - accuracy: 0.4523 - val_loss: 1.5612 - val_accuracy: 0.4173
[fed-epoch 1] cid: 4
Train on 10000 samples, validate on 10000 samples
Using learning rate 0.0001
Epoch 1/15
10000/10000 [==============================] - 9s 879us/sample - loss: 2.0996 - accuracy: 0.1833 - val_loss: 1.9634 - val_accuracy: 0.2192
Using learning rate 0.0001
Epoch 2/15
10000/10000 [==============================] - 8s 804us/sample - loss: 1.9285 - accuracy: 0.2357 - val_loss: 1.8651 - val_accuracy: 0.2777
Using learning rate 0.0001
Epoch 3/15
10000/10000 [==============================] - 8s 805us/sample - loss: 1.8233 - accuracy: 0.2860 - val_loss: 1.7752 - val_accuracy: 0.3140
Using learning rate 0.0001
Epoch 4/15
10000/10000 [==============================] - 8s 805us/sample - loss: 1.7540 - accuracy: 0.3213 - val_loss: 1.7334 - val_accuracy: 0.3283
Using learning rate 0.0001
Epoch 5/15
10000/10000 [==============================] - 8s 806us/sample - loss: 1.6893 - accuracy: 0.3525 - val_loss: 1.6860 - val_accuracy: 0.3536
Using learning rate 0.0001
Epoch 6/15
10000/10000 [==============================] - 8s 805us/sample - loss: 1.6377 - accuracy: 0.3782 - val_loss: 1.6799 - val_accuracy: 0.3733
Using learning rate 0.0001
Epoch 7/15
10000/10000 [==============================] - 8s 806us/sample - loss: 1.5794 - accuracy: 0.4125 - val_loss: 1.6484 - val_accuracy: 0.3876
Using learning rate 0.0001
Epoch 8/15
10000/10000 [==============================] - 8s 806us/sample - loss: 1.5379 - accuracy: 0.4279 - val_loss: 1.6127 - val_accuracy: 0.4080
Using learning rate 0.0001
Epoch 9/15
10000/10000 [==============================] - 8s 805us/sample - loss: 1.4905 - accuracy: 0.4481 - val_loss: 1.5942 - val_accuracy: 0.4158
Using learning rate 0.0001
Epoch 10/15
10000/10000 [==============================] - 8s 805us/sample - loss: 1.4589 - accuracy: 0.4616 - val_loss: 1.5811 - val_accuracy: 0.4280
Using learning rate 0.0001
Epoch 11/15
10000/10000 [==============================] - 8s 806us/sample - loss: 1.4137 - accuracy: 0.4842 - val_loss: 1.5561 - val_accuracy: 0.4376
Using learning rate 0.0001
Epoch 12/15
10000/10000 [==============================] - 8s 805us/sample - loss: 1.3509 - accuracy: 0.5164 - val_loss: 1.5610 - val_accuracy: 0.4435
Using learning rate 0.0001
Epoch 13/15
10000/10000 [==============================] - 8s 806us/sample - loss: 1.3066 - accuracy: 0.5366 - val_loss: 1.5044 - val_accuracy: 0.4719
Using learning rate 0.0001
Epoch 14/15
10000/10000 [==============================] - 8s 804us/sample - loss: 1.2399 - accuracy: 0.5642 - val_loss: 1.5470 - val_accuracy: 0.4602
Using learning rate 0.0001
Epoch 15/15
10000/10000 [==============================] - 8s 804us/sample - loss: 1.1856 - accuracy: 0.5814 - val_loss: 1.5741 - val_accuracy: 0.4606
[fed-epoch 2] cid: 0
Train on 10000 samples, validate on 10000 samples
Using learning rate 0.0001
Epoch 1/15
10000/10000 [==============================] - 8s 806us/sample - loss: 1.9892 - accuracy: 0.2120 - val_loss: 1.8687 - val_accuracy: 0.2656
Using learning rate 0.0001
Epoch 2/15
10000/10000 [==============================] - 8s 806us/sample - loss: 1.7834 - accuracy: 0.3149 - val_loss: 1.7262 - val_accuracy: 0.3483
Using learning rate 0.0001
Epoch 3/15
10000/10000 [==============================] - 8s 806us/sample - loss: 1.6516 - accuracy: 0.3791 - val_loss: 1.6285 - val_accuracy: 0.3966
Using learning rate 0.0001
Epoch 4/15
10000/10000 [==============================] - 8s 808us/sample - loss: 1.5709 - accuracy: 0.4050 - val_loss: 1.5784 - val_accuracy: 0.4136
Using learning rate 0.0001
Epoch 5/15
10000/10000 [==============================] - 8s 806us/sample - loss: 1.5020 - accuracy: 0.4375 - val_loss: 1.5533 - val_accuracy: 0.4358
Using learning rate 0.0001
Epoch 6/15
10000/10000 [==============================] - 8s 806us/sample - loss: 1.4458 - accuracy: 0.4663 - val_loss: 1.4929 - val_accuracy: 0.4639
Using learning rate 0.0001
Epoch 7/15
10000/10000 [==============================] - 8s 806us/sample - loss: 1.3766 - accuracy: 0.4927 - val_loss: 1.4903 - val_accuracy: 0.4642
Using learning rate 0.0001
Epoch 8/15
10000/10000 [==============================] - 8s 806us/sample - loss: 1.3140 - accuracy: 0.5262 - val_loss: 1.4787 - val_accuracy: 0.4820
Using learning rate 0.0001
Epoch 9/15
10000/10000 [==============================] - 8s 806us/sample - loss: 1.2476 - accuracy: 0.5505 - val_loss: 1.4464 - val_accuracy: 0.4965
Using learning rate 0.0001
Epoch 10/15
10000/10000 [==============================] - 8s 806us/sample - loss: 1.1886 - accuracy: 0.5756 - val_loss: 1.4250 - val_accuracy: 0.5132
Using learning rate 0.0001
Epoch 11/15
10000/10000 [==============================] - 8s 806us/sample - loss: 1.1228 - accuracy: 0.6044 - val_loss: 1.4273 - val_accuracy: 0.5196
Using learning rate 0.0001
Epoch 12/15
10000/10000 [==============================] - 8s 806us/sample - loss: 1.0597 - accuracy: 0.6367 - val_loss: 1.4703 - val_accuracy: 0.5150
Using learning rate 0.0001
Epoch 13/15
10000/10000 [==============================] - 8s 807us/sample - loss: 0.9813 - accuracy: 0.6637 - val_loss: 1.5652 - val_accuracy: 0.5085
Using learning rate 0.0001
Epoch 14/15
10000/10000 [==============================] - 8s 806us/sample - loss: 0.9299 - accuracy: 0.6855 - val_loss: 1.5180 - val_accuracy: 0.5199
Using learning rate 0.0001
Epoch 15/15
10000/10000 [==============================] - 8s 807us/sample - loss: 0.8491 - accuracy: 0.7179 - val_loss: 1.6128 - val_accuracy: 0.5086
[fed-epoch 2] cid: 1
Train on 10000 samples, validate on 10000 samples
Using learning rate 0.0001
Epoch 1/15
10000/10000 [==============================] - 8s 809us/sample - loss: 1.1226 - accuracy: 0.5952 - val_loss: 1.5589 - val_accuracy: 0.4967
Using learning rate 0.0001
Epoch 2/15
10000/10000 [==============================] - 8s 807us/sample - loss: 1.0308 - accuracy: 0.6373 - val_loss: 1.5246 - val_accuracy: 0.5091
Using learning rate 0.0001
Epoch 3/15
10000/10000 [==============================] - 8s 806us/sample - loss: 0.9641 - accuracy: 0.6629 - val_loss: 1.6413 - val_accuracy: 0.4916
Using learning rate 0.0001
Epoch 4/15
10000/10000 [==============================] - 8s 805us/sample - loss: 0.9187 - accuracy: 0.6793 - val_loss: 1.6245 - val_accuracy: 0.5083
Using learning rate 0.0001
Epoch 5/15
10000/10000 [==============================] - 8s 807us/sample - loss: 0.8636 - accuracy: 0.7030 - val_loss: 1.6311 - val_accuracy: 0.5108
Using learning rate 0.0001
Epoch 6/15
10000/10000 [==============================] - 8s 806us/sample - loss: 0.8086 - accuracy: 0.7281 - val_loss: 1.6523 - val_accuracy: 0.5216
Using learning rate 0.0001
Epoch 7/15
10000/10000 [==============================] - 8s 806us/sample - loss: 0.7536 - accuracy: 0.7471 - val_loss: 1.7639 - val_accuracy: 0.5118
Using learning rate 0.0001
Epoch 8/15
10000/10000 [==============================] - 8s 805us/sample - loss: 0.7163 - accuracy: 0.7653 - val_loss: 2.0261 - val_accuracy: 0.4949
Using learning rate 0.0001
Epoch 9/15
10000/10000 [==============================] - 8s 806us/sample - loss: 0.6737 - accuracy: 0.7839 - val_loss: 1.8394 - val_accuracy: 0.5166
Using learning rate 0.0001
Epoch 10/15
10000/10000 [==============================] - 8s 808us/sample - loss: 0.6223 - accuracy: 0.8048 - val_loss: 1.9564 - val_accuracy: 0.5097
Using learning rate 0.0001
Epoch 11/15
10000/10000 [==============================] - 8s 810us/sample - loss: 0.5796 - accuracy: 0.8212 - val_loss: 2.0003 - val_accuracy: 0.5064
Using learning rate 0.0001
Epoch 12/15
10000/10000 [==============================] - 8s 811us/sample - loss: 0.5380 - accuracy: 0.8386 - val_loss: 2.1571 - val_accuracy: 0.5097
Using learning rate 0.0001
Epoch 13/15
10000/10000 [==============================] - 8s 811us/sample - loss: 0.5310 - accuracy: 0.8424 - val_loss: 2.2646 - val_accuracy: 0.4862
Using learning rate 0.0001
Epoch 14/15
10000/10000 [==============================] - 8s 810us/sample - loss: 0.4917 - accuracy: 0.8580 - val_loss: 2.2006 - val_accuracy: 0.5078
Using learning rate 0.0001
Epoch 15/15
10000/10000 [==============================] - 8s 809us/sample - loss: 0.4350 - accuracy: 0.8792 - val_loss: 2.2823 - val_accuracy: 0.5105
isolating attack on cid: 1 in fed-epoch: 2
WARNING:tensorflow:Layer conv2d_25 is casting an input tensor from dtype float64 to the layer's dtype of float32, which is new behavior in TensorFlow 2.  The layer has dtype float32 because it's dtype defaults to floatx.
If you intended to run this layer in float32, you can safely ignore this warning. If in doubt, this warning is likely only an issue if you are porting a TensorFlow 1.X model to TensorFlow 2.
To change all layers to have dtype float64 by default, call `tf.keras.backend.set_floatx('float64')`. To change just this layer, pass dtype='float64' to the layer constructor. If you are the author of this layer, you can disable autocasting by passing autocast=False to the base Layer constructor.
Target model test accuracy 0.5
Epoch 0 over :Attack test accuracy: 0.5, Best accuracy : 0.5
Epoch 1 over :Attack test accuracy: 0.6542778015136719, Best accuracy : 0.6542778015136719
Epoch 2 over :Attack test accuracy: 0.6791666746139526, Best accuracy : 0.6791666746139526
Epoch 3 over :Attack test accuracy: 0.6905555725097656, Best accuracy : 0.6905555725097656
Epoch 4 over :Attack test accuracy: 0.6854444742202759, Best accuracy : 0.6905555725097656
Epoch 5 over :Attack test accuracy: 0.6934444308280945, Best accuracy : 0.6934444308280945
Epoch 6 over :Attack test accuracy: 0.7071666717529297, Best accuracy : 0.7071666717529297
Epoch 7 over :Attack test accuracy: 0.7108888626098633, Best accuracy : 0.7108888626098633
Epoch 8 over :Attack test accuracy: 0.711388885974884, Best accuracy : 0.711388885974884
Epoch 9 over :Attack test accuracy: 0.7128333449363708, Best accuracy : 0.7128333449363708
[fed-epoch 2] cid: 2
Train on 10000 samples, validate on 10000 samples
Using learning rate 0.0001
Epoch 1/15
10000/10000 [==============================] - 8s 812us/sample - loss: 2.0195 - accuracy: 0.2054 - val_loss: 1.8760 - val_accuracy: 0.2689
Using learning rate 0.0001
Epoch 2/15
10000/10000 [==============================] - 8s 813us/sample - loss: 1.8175 - accuracy: 0.2766 - val_loss: 1.8683 - val_accuracy: 0.2686
Using learning rate 0.0001
Epoch 3/15
10000/10000 [==============================] - 8s 813us/sample - loss: 1.7128 - accuracy: 0.3290 - val_loss: 1.7363 - val_accuracy: 0.3265
Using learning rate 0.0001
Epoch 4/15
10000/10000 [==============================] - 8s 811us/sample - loss: 1.6488 - accuracy: 0.3662 - val_loss: 1.6373 - val_accuracy: 0.3740
Using learning rate 0.0001
Epoch 5/15
10000/10000 [==============================] - 8s 813us/sample - loss: 1.5710 - accuracy: 0.3977 - val_loss: 1.5970 - val_accuracy: 0.4034
Using learning rate 0.0001
Epoch 6/15
10000/10000 [==============================] - 8s 813us/sample - loss: 1.5154 - accuracy: 0.4298 - val_loss: 1.5732 - val_accuracy: 0.4164
Using learning rate 0.0001
Epoch 7/15
10000/10000 [==============================] - 8s 812us/sample - loss: 1.4496 - accuracy: 0.4494 - val_loss: 1.5691 - val_accuracy: 0.4236
Using learning rate 0.0001
Epoch 8/15
10000/10000 [==============================] - 8s 811us/sample - loss: 1.3918 - accuracy: 0.4824 - val_loss: 1.5533 - val_accuracy: 0.4396
Using learning rate 0.0001
Epoch 9/15
10000/10000 [==============================] - 8s 812us/sample - loss: 1.3291 - accuracy: 0.5171 - val_loss: 1.4878 - val_accuracy: 0.4688
Using learning rate 0.0001
Epoch 10/15
10000/10000 [==============================] - 8s 811us/sample - loss: 1.2713 - accuracy: 0.5443 - val_loss: 1.4955 - val_accuracy: 0.4807
Using learning rate 0.0001
Epoch 11/15
10000/10000 [==============================] - 8s 811us/sample - loss: 1.2026 - accuracy: 0.5706 - val_loss: 1.4468 - val_accuracy: 0.5034
Using learning rate 0.0001
Epoch 12/15
10000/10000 [==============================] - 8s 812us/sample - loss: 1.1423 - accuracy: 0.5991 - val_loss: 1.4565 - val_accuracy: 0.5091
Using learning rate 0.0001
Epoch 13/15
10000/10000 [==============================] - 8s 813us/sample - loss: 1.0901 - accuracy: 0.6219 - val_loss: 1.4837 - val_accuracy: 0.5079
Using learning rate 0.0001
Epoch 14/15
10000/10000 [==============================] - 8s 812us/sample - loss: 1.0151 - accuracy: 0.6498 - val_loss: 1.5269 - val_accuracy: 0.5130
Using learning rate 0.0001
Epoch 15/15
10000/10000 [==============================] - 8s 810us/sample - loss: 0.9673 - accuracy: 0.6698 - val_loss: 1.5819 - val_accuracy: 0.5107
[fed-epoch 2] cid: 3
Train on 10000 samples, validate on 10000 samples
Using learning rate 0.0001
Epoch 1/15
10000/10000 [==============================] - 8s 812us/sample - loss: 2.1004 - accuracy: 0.1790 - val_loss: 1.9778 - val_accuracy: 0.2206
Using learning rate 0.0001
Epoch 2/15
10000/10000 [==============================] - 8s 810us/sample - loss: 1.9268 - accuracy: 0.2309 - val_loss: 1.9117 - val_accuracy: 0.2459
Using learning rate 0.0001
Epoch 3/15
10000/10000 [==============================] - 8s 810us/sample - loss: 1.8570 - accuracy: 0.2631 - val_loss: 1.8088 - val_accuracy: 0.2748
Using learning rate 0.0001
Epoch 4/15
10000/10000 [==============================] - 8s 810us/sample - loss: 1.7855 - accuracy: 0.2993 - val_loss: 1.8019 - val_accuracy: 0.2875
Using learning rate 0.0001
Epoch 5/15
10000/10000 [==============================] - 8s 812us/sample - loss: 1.7352 - accuracy: 0.3254 - val_loss: 1.6994 - val_accuracy: 0.3387
Using learning rate 0.0001
Epoch 6/15
10000/10000 [==============================] - 8s 809us/sample - loss: 1.6861 - accuracy: 0.3550 - val_loss: 1.6685 - val_accuracy: 0.3658
Using learning rate 0.0001
Epoch 7/15
10000/10000 [==============================] - 8s 810us/sample - loss: 1.6152 - accuracy: 0.3785 - val_loss: 1.6464 - val_accuracy: 0.3768
Using learning rate 0.0001
Epoch 8/15
10000/10000 [==============================] - 8s 812us/sample - loss: 1.5603 - accuracy: 0.4062 - val_loss: 1.5972 - val_accuracy: 0.4005
Using learning rate 0.0001
Epoch 9/15
10000/10000 [==============================] - 8s 810us/sample - loss: 1.5002 - accuracy: 0.4269 - val_loss: 1.6152 - val_accuracy: 0.4080
Using learning rate 0.0001
Epoch 10/15
10000/10000 [==============================] - 8s 810us/sample - loss: 1.4615 - accuracy: 0.4481 - val_loss: 1.5825 - val_accuracy: 0.4171
Using learning rate 0.0001
Epoch 11/15
10000/10000 [==============================] - 8s 813us/sample - loss: 1.4048 - accuracy: 0.4713 - val_loss: 1.5488 - val_accuracy: 0.4282
Using learning rate 0.0001
Epoch 12/15
10000/10000 [==============================] - 8s 811us/sample - loss: 1.3626 - accuracy: 0.4927 - val_loss: 1.5052 - val_accuracy: 0.4476
Using learning rate 0.0001
Epoch 13/15
10000/10000 [==============================] - 8s 812us/sample - loss: 1.2892 - accuracy: 0.5250 - val_loss: 1.4869 - val_accuracy: 0.4678
Using learning rate 0.0001
Epoch 14/15
10000/10000 [==============================] - 8s 811us/sample - loss: 1.2361 - accuracy: 0.5416 - val_loss: 1.5063 - val_accuracy: 0.4702
Using learning rate 0.0001
Epoch 15/15
10000/10000 [==============================] - 8s 810us/sample - loss: 1.1771 - accuracy: 0.5763 - val_loss: 1.4617 - val_accuracy: 0.4946
[fed-epoch 2] cid: 4
Train on 10000 samples, validate on 10000 samples
Using learning rate 0.0001
Epoch 1/15
10000/10000 [==============================] - 8s 816us/sample - loss: 2.2158 - accuracy: 0.1489 - val_loss: 2.0043 - val_accuracy: 0.2123
Using learning rate 0.0001
Epoch 2/15
10000/10000 [==============================] - 8s 813us/sample - loss: 1.9292 - accuracy: 0.2292 - val_loss: 1.8968 - val_accuracy: 0.2384
Using learning rate 0.0001
Epoch 3/15
10000/10000 [==============================] - 8s 811us/sample - loss: 1.8579 - accuracy: 0.2652 - val_loss: 1.8007 - val_accuracy: 0.2982
Using learning rate 0.0001
Epoch 4/15
10000/10000 [==============================] - 8s 811us/sample - loss: 1.7776 - accuracy: 0.3107 - val_loss: 1.7914 - val_accuracy: 0.3026
Using learning rate 0.0001
Epoch 5/15
10000/10000 [==============================] - 8s 810us/sample - loss: 1.7124 - accuracy: 0.3401 - val_loss: 1.6828 - val_accuracy: 0.3653
Using learning rate 0.0001
Epoch 6/15
10000/10000 [==============================] - 8s 813us/sample - loss: 1.6448 - accuracy: 0.3798 - val_loss: 1.6135 - val_accuracy: 0.4132
Using learning rate 0.0001
Epoch 7/15
10000/10000 [==============================] - 8s 810us/sample - loss: 1.5647 - accuracy: 0.4236 - val_loss: 1.5887 - val_accuracy: 0.4210
Using learning rate 0.0001
Epoch 8/15
10000/10000 [==============================] - 8s 811us/sample - loss: 1.4896 - accuracy: 0.4460 - val_loss: 1.5506 - val_accuracy: 0.4291
Using learning rate 0.0001
Epoch 9/15
10000/10000 [==============================] - 8s 812us/sample - loss: 1.4175 - accuracy: 0.4822 - val_loss: 1.5652 - val_accuracy: 0.4437
Using learning rate 0.0001
Epoch 10/15
10000/10000 [==============================] - 8s 811us/sample - loss: 1.3580 - accuracy: 0.5112 - val_loss: 1.4406 - val_accuracy: 0.4864
Using learning rate 0.0001
Epoch 11/15
10000/10000 [==============================] - 8s 810us/sample - loss: 1.2690 - accuracy: 0.5483 - val_loss: 1.4482 - val_accuracy: 0.4948
Using learning rate 0.0001
Epoch 12/15
10000/10000 [==============================] - 8s 811us/sample - loss: 1.2123 - accuracy: 0.5703 - val_loss: 1.4483 - val_accuracy: 0.4985
Using learning rate 0.0001
Epoch 13/15
10000/10000 [==============================] - 8s 811us/sample - loss: 1.1570 - accuracy: 0.5948 - val_loss: 1.4915 - val_accuracy: 0.4919
Using learning rate 0.0001
Epoch 14/15
10000/10000 [==============================] - 8s 812us/sample - loss: 1.0800 - accuracy: 0.6214 - val_loss: 1.5387 - val_accuracy: 0.4880
Using learning rate 0.0001
Epoch 15/15
10000/10000 [==============================] - 8s 812us/sample - loss: 1.0038 - accuracy: 0.6563 - val_loss: 1.4979 - val_accuracy: 0.5164
[fed-epoch 3] cid: 0
Train on 10000 samples, validate on 10000 samples
Using learning rate 0.0001
Epoch 1/15
10000/10000 [==============================] - 8s 813us/sample - loss: 1.4991 - accuracy: 0.4554 - val_loss: 1.4330 - val_accuracy: 0.4849
Using learning rate 0.0001
Epoch 2/15
10000/10000 [==============================] - 8s 811us/sample - loss: 1.3222 - accuracy: 0.5285 - val_loss: 1.3935 - val_accuracy: 0.5115
Using learning rate 0.0001
Epoch 3/15
10000/10000 [==============================] - 8s 812us/sample - loss: 1.2093 - accuracy: 0.5756 - val_loss: 1.3597 - val_accuracy: 0.5319
Using learning rate 0.0001
Epoch 4/15
10000/10000 [==============================] - 8s 811us/sample - loss: 1.1376 - accuracy: 0.6051 - val_loss: 1.4039 - val_accuracy: 0.5277
Using learning rate 0.0001
Epoch 5/15
10000/10000 [==============================] - 8s 812us/sample - loss: 1.0544 - accuracy: 0.6431 - val_loss: 1.3641 - val_accuracy: 0.5400
Using learning rate 0.0001
Epoch 6/15
10000/10000 [==============================] - 8s 811us/sample - loss: 0.9645 - accuracy: 0.6713 - val_loss: 1.3614 - val_accuracy: 0.5539
Using learning rate 0.0001
Epoch 7/15
10000/10000 [==============================] - 8s 810us/sample - loss: 0.8751 - accuracy: 0.7114 - val_loss: 1.5076 - val_accuracy: 0.5369
Using learning rate 0.0001
Epoch 8/15
10000/10000 [==============================] - 8s 811us/sample - loss: 0.7792 - accuracy: 0.7531 - val_loss: 1.4872 - val_accuracy: 0.5476
Using learning rate 0.0001
Epoch 9/15
10000/10000 [==============================] - 8s 812us/sample - loss: 0.6973 - accuracy: 0.7834 - val_loss: 1.6251 - val_accuracy: 0.5369
Using learning rate 0.0001
Epoch 10/15
10000/10000 [==============================] - 8s 811us/sample - loss: 0.6206 - accuracy: 0.8087 - val_loss: 1.7603 - val_accuracy: 0.5265
Using learning rate 0.0001
Epoch 11/15
10000/10000 [==============================] - 8s 811us/sample - loss: 0.5612 - accuracy: 0.8314 - val_loss: 1.9221 - val_accuracy: 0.5244
Using learning rate 0.0001
Epoch 12/15
10000/10000 [==============================] - 8s 811us/sample - loss: 0.4864 - accuracy: 0.8625 - val_loss: 2.1278 - val_accuracy: 0.5127
Using learning rate 0.0001
Epoch 13/15
10000/10000 [==============================] - 8s 809us/sample - loss: 0.4252 - accuracy: 0.8872 - val_loss: 1.9984 - val_accuracy: 0.5511
Using learning rate 0.0001
Epoch 14/15
10000/10000 [==============================] - 8s 811us/sample - loss: 0.3831 - accuracy: 0.9052 - val_loss: 2.2942 - val_accuracy: 0.5055
Using learning rate 0.0001
Epoch 15/15
10000/10000 [==============================] - 8s 811us/sample - loss: 0.3528 - accuracy: 0.9154 - val_loss: 2.2026 - val_accuracy: 0.5407
[fed-epoch 3] cid: 1
Train on 10000 samples, validate on 10000 samples
Using learning rate 0.0001
Epoch 1/15
10000/10000 [==============================] - 8s 814us/sample - loss: 0.5159 - accuracy: 0.8434 - val_loss: 2.2508 - val_accuracy: 0.5106
Using learning rate 0.0001
Epoch 2/15
10000/10000 [==============================] - 8s 810us/sample - loss: 0.4451 - accuracy: 0.8732 - val_loss: 2.3952 - val_accuracy: 0.5171
Using learning rate 0.0001
Epoch 3/15
10000/10000 [==============================] - 8s 811us/sample - loss: 0.3901 - accuracy: 0.8981 - val_loss: 2.4735 - val_accuracy: 0.5092
Using learning rate 0.0001
Epoch 4/15
10000/10000 [==============================] - 8s 810us/sample - loss: 0.3431 - accuracy: 0.9164 - val_loss: 2.6516 - val_accuracy: 0.5114
Using learning rate 0.0001
Epoch 5/15
10000/10000 [==============================] - 8s 811us/sample - loss: 0.3451 - accuracy: 0.9181 - val_loss: 2.8065 - val_accuracy: 0.5079
Using learning rate 0.0001
Epoch 6/15
10000/10000 [==============================] - 8s 810us/sample - loss: 0.3351 - accuracy: 0.9203 - val_loss: 2.8480 - val_accuracy: 0.5111
Using learning rate 0.0001
Epoch 7/15
10000/10000 [==============================] - 8s 810us/sample - loss: 0.3236 - accuracy: 0.9248 - val_loss: 2.8776 - val_accuracy: 0.5007
Using learning rate 0.0001
Epoch 8/15
10000/10000 [==============================] - 8s 810us/sample - loss: 0.2999 - accuracy: 0.9362 - val_loss: 2.8721 - val_accuracy: 0.5019
Using learning rate 0.0001
Epoch 9/15
10000/10000 [==============================] - 8s 810us/sample - loss: 0.3021 - accuracy: 0.9349 - val_loss: 2.9631 - val_accuracy: 0.4978
Using learning rate 0.0001
Epoch 10/15
10000/10000 [==============================] - 8s 807us/sample - loss: 0.2561 - accuracy: 0.9535 - val_loss: 3.2429 - val_accuracy: 0.4930
Using learning rate 0.0001
Epoch 11/15
10000/10000 [==============================] - 8s 810us/sample - loss: 0.2369 - accuracy: 0.9608 - val_loss: 3.3142 - val_accuracy: 0.5144
Using learning rate 0.0001
Epoch 12/15
10000/10000 [==============================] - 8s 818us/sample - loss: 0.2662 - accuracy: 0.9510 - val_loss: 3.1733 - val_accuracy: 0.4989
Using learning rate 0.0001
Epoch 13/15
10000/10000 [==============================] - 8s 808us/sample - loss: 0.2709 - accuracy: 0.9477 - val_loss: 2.9537 - val_accuracy: 0.5018
Using learning rate 0.0001
Epoch 14/15
10000/10000 [==============================] - 8s 810us/sample - loss: 0.2408 - accuracy: 0.9595 - val_loss: 3.3228 - val_accuracy: 0.5032
Using learning rate 0.0001
Epoch 15/15
10000/10000 [==============================] - 8s 808us/sample - loss: 0.2332 - accuracy: 0.9635 - val_loss: 3.3104 - val_accuracy: 0.5063
[fed-epoch 3] cid: 2
Train on 10000 samples, validate on 10000 samples
Using learning rate 0.0001
Epoch 1/15
10000/10000 [==============================] - 8s 812us/sample - loss: 1.4760 - accuracy: 0.4638 - val_loss: 1.4210 - val_accuracy: 0.4957
Using learning rate 0.0001
Epoch 2/15
10000/10000 [==============================] - 8s 810us/sample - loss: 1.3107 - accuracy: 0.5357 - val_loss: 1.3481 - val_accuracy: 0.5317
Using learning rate 0.0001
Epoch 3/15
10000/10000 [==============================] - 8s 811us/sample - loss: 1.2057 - accuracy: 0.5808 - val_loss: 1.3638 - val_accuracy: 0.5333
Using learning rate 0.0001
Epoch 4/15
10000/10000 [==============================] - 8s 809us/sample - loss: 1.1273 - accuracy: 0.6031 - val_loss: 1.3448 - val_accuracy: 0.5477
Using learning rate 0.0001
Epoch 5/15
10000/10000 [==============================] - 8s 809us/sample - loss: 1.0451 - accuracy: 0.6429 - val_loss: 1.4614 - val_accuracy: 0.5102
Using learning rate 0.0001
Epoch 6/15
10000/10000 [==============================] - 8s 809us/sample - loss: 0.9689 - accuracy: 0.6715 - val_loss: 1.4022 - val_accuracy: 0.5427
Using learning rate 0.0001
Epoch 7/15
10000/10000 [==============================] - 8s 807us/sample - loss: 0.8815 - accuracy: 0.7038 - val_loss: 1.5144 - val_accuracy: 0.5314
Using learning rate 0.0001
Epoch 8/15
10000/10000 [==============================] - 8s 810us/sample - loss: 0.8008 - accuracy: 0.7486 - val_loss: 1.5577 - val_accuracy: 0.5323
Using learning rate 0.0001
Epoch 9/15
10000/10000 [==============================] - 8s 809us/sample - loss: 0.7129 - accuracy: 0.7704 - val_loss: 1.6624 - val_accuracy: 0.5191
Using learning rate 0.0001
Epoch 10/15
10000/10000 [==============================] - 8s 809us/sample - loss: 0.6294 - accuracy: 0.8076 - val_loss: 1.6754 - val_accuracy: 0.5530
Using learning rate 0.0001
Epoch 11/15
10000/10000 [==============================] - 8s 811us/sample - loss: 0.5732 - accuracy: 0.8318 - val_loss: 1.7937 - val_accuracy: 0.5402
Using learning rate 0.0001
Epoch 12/15
10000/10000 [==============================] - 8s 810us/sample - loss: 0.4911 - accuracy: 0.8618 - val_loss: 1.8807 - val_accuracy: 0.5416
Using learning rate 0.0001
Epoch 13/15
10000/10000 [==============================] - 8s 810us/sample - loss: 0.4582 - accuracy: 0.8768 - val_loss: 2.0454 - val_accuracy: 0.5345
Using learning rate 0.0001
Epoch 14/15
10000/10000 [==============================] - 8s 810us/sample - loss: 0.3829 - accuracy: 0.9073 - val_loss: 2.1920 - val_accuracy: 0.5295
Using learning rate 0.0001
Epoch 15/15
10000/10000 [==============================] - 8s 808us/sample - loss: 0.3506 - accuracy: 0.9190 - val_loss: 2.3827 - val_accuracy: 0.5385
[fed-epoch 3] cid: 3
Train on 10000 samples, validate on 10000 samples
Using learning rate 0.0001
Epoch 1/15
10000/10000 [==============================] - 8s 811us/sample - loss: 1.5253 - accuracy: 0.4490 - val_loss: 1.4557 - val_accuracy: 0.4634
Using learning rate 0.0001
Epoch 2/15
10000/10000 [==============================] - 8s 810us/sample - loss: 1.3812 - accuracy: 0.5059 - val_loss: 1.3897 - val_accuracy: 0.5030
Using learning rate 0.0001
Epoch 3/15
10000/10000 [==============================] - 8s 810us/sample - loss: 1.2913 - accuracy: 0.5381 - val_loss: 1.3343 - val_accuracy: 0.5364
Using learning rate 0.0001
Epoch 4/15
10000/10000 [==============================] - 8s 810us/sample - loss: 1.2181 - accuracy: 0.5679 - val_loss: 1.3298 - val_accuracy: 0.5365
Using learning rate 0.0001
Epoch 5/15
10000/10000 [==============================] - 8s 810us/sample - loss: 1.1480 - accuracy: 0.5966 - val_loss: 1.3701 - val_accuracy: 0.5249
Using learning rate 0.0001
Epoch 6/15
10000/10000 [==============================] - 8s 810us/sample - loss: 1.0656 - accuracy: 0.6307 - val_loss: 1.3661 - val_accuracy: 0.5399
Using learning rate 0.0001
Epoch 7/15
10000/10000 [==============================] - 8s 810us/sample - loss: 0.9934 - accuracy: 0.6553 - val_loss: 1.4215 - val_accuracy: 0.5364
Using learning rate 0.0001
Epoch 8/15
10000/10000 [==============================] - 8s 810us/sample - loss: 0.9230 - accuracy: 0.6817 - val_loss: 1.3926 - val_accuracy: 0.5490
Using learning rate 0.0001
Epoch 9/15
10000/10000 [==============================] - 8s 809us/sample - loss: 0.8246 - accuracy: 0.7221 - val_loss: 1.6736 - val_accuracy: 0.5041
Using learning rate 0.0001
Epoch 10/15
10000/10000 [==============================] - 8s 811us/sample - loss: 0.7555 - accuracy: 0.7570 - val_loss: 1.5540 - val_accuracy: 0.5371
Using learning rate 0.0001
Epoch 11/15
10000/10000 [==============================] - 8s 811us/sample - loss: 0.6669 - accuracy: 0.7857 - val_loss: 1.6047 - val_accuracy: 0.5491
Using learning rate 0.0001
Epoch 12/15
10000/10000 [==============================] - 8s 809us/sample - loss: 0.5940 - accuracy: 0.8160 - val_loss: 1.7620 - val_accuracy: 0.5338
Using learning rate 0.0001
Epoch 13/15
10000/10000 [==============================] - 8s 809us/sample - loss: 0.5173 - accuracy: 0.8510 - val_loss: 1.8824 - val_accuracy: 0.5333
Using learning rate 0.0001
Epoch 14/15
10000/10000 [==============================] - 8s 810us/sample - loss: 0.4779 - accuracy: 0.8677 - val_loss: 2.0415 - val_accuracy: 0.5114
Using learning rate 0.0001
Epoch 15/15
10000/10000 [==============================] - 8s 812us/sample - loss: 0.4268 - accuracy: 0.8836 - val_loss: 2.0570 - val_accuracy: 0.5488
[fed-epoch 3] cid: 4
Train on 10000 samples, validate on 10000 samples
Using learning rate 0.0001
Epoch 1/15
10000/10000 [==============================] - 8s 813us/sample - loss: 1.5120 - accuracy: 0.4634 - val_loss: 1.4390 - val_accuracy: 0.4825
Using learning rate 0.0001
Epoch 2/15
10000/10000 [==============================] - 8s 810us/sample - loss: 1.3501 - accuracy: 0.5211 - val_loss: 1.3783 - val_accuracy: 0.5158
Using learning rate 0.0001
Epoch 3/15
10000/10000 [==============================] - 8s 810us/sample - loss: 1.2727 - accuracy: 0.5576 - val_loss: 1.3751 - val_accuracy: 0.5112
Using learning rate 0.0001
Epoch 4/15
10000/10000 [==============================] - 8s 812us/sample - loss: 1.1965 - accuracy: 0.5895 - val_loss: 1.4696 - val_accuracy: 0.4990
Using learning rate 0.0001
Epoch 5/15
10000/10000 [==============================] - 8s 812us/sample - loss: 1.1230 - accuracy: 0.6105 - val_loss: 1.3316 - val_accuracy: 0.5466
Using learning rate 0.0001
Epoch 6/15
10000/10000 [==============================] - 8s 810us/sample - loss: 1.0335 - accuracy: 0.6451 - val_loss: 1.4070 - val_accuracy: 0.5206
Using learning rate 0.0001
Epoch 7/15
10000/10000 [==============================] - 8s 811us/sample - loss: 0.9602 - accuracy: 0.6715 - val_loss: 1.5079 - val_accuracy: 0.5221
Using learning rate 0.0001
Epoch 8/15
10000/10000 [==============================] - 8s 810us/sample - loss: 0.8896 - accuracy: 0.7042 - val_loss: 1.4395 - val_accuracy: 0.5471
Using learning rate 0.0001
Epoch 9/15
10000/10000 [==============================] - 8s 809us/sample - loss: 0.7918 - accuracy: 0.7464 - val_loss: 1.6316 - val_accuracy: 0.5142
Using learning rate 0.0001
Epoch 10/15
10000/10000 [==============================] - 8s 808us/sample - loss: 0.7271 - accuracy: 0.7634 - val_loss: 1.7168 - val_accuracy: 0.5201
Using learning rate 0.0001
Epoch 11/15
10000/10000 [==============================] - 8s 809us/sample - loss: 0.6473 - accuracy: 0.8023 - val_loss: 1.6732 - val_accuracy: 0.5488
Using learning rate 0.0001
Epoch 12/15
10000/10000 [==============================] - 8s 809us/sample - loss: 0.5659 - accuracy: 0.8319 - val_loss: 1.7357 - val_accuracy: 0.5461
Using learning rate 0.0001
Epoch 13/15
10000/10000 [==============================] - 8s 809us/sample - loss: 0.5190 - accuracy: 0.8510 - val_loss: 1.8380 - val_accuracy: 0.5408
Using learning rate 0.0001
Epoch 14/15
10000/10000 [==============================] - 8s 811us/sample - loss: 0.4499 - accuracy: 0.8782 - val_loss: 1.9900 - val_accuracy: 0.5476
Using learning rate 0.0001
Epoch 15/15
10000/10000 [==============================] - 8s 809us/sample - loss: 0.4189 - accuracy: 0.8973 - val_loss: 2.1336 - val_accuracy: 0.5296
[fed-epoch 4] cid: 0
Train on 10000 samples, validate on 10000 samples
Using learning rate 0.0001
Epoch 1/15
10000/10000 [==============================] - 8s 812us/sample - loss: 1.1793 - accuracy: 0.6099 - val_loss: 1.3772 - val_accuracy: 0.5491
Using learning rate 0.0001
Epoch 2/15
10000/10000 [==============================] - 8s 811us/sample - loss: 0.9968 - accuracy: 0.6744 - val_loss: 1.3585 - val_accuracy: 0.5627
Using learning rate 0.0001
Epoch 3/15
10000/10000 [==============================] - 8s 809us/sample - loss: 0.8479 - accuracy: 0.7238 - val_loss: 1.4337 - val_accuracy: 0.5532
Using learning rate 0.0001
Epoch 4/15
10000/10000 [==============================] - 8s 811us/sample - loss: 0.7663 - accuracy: 0.7542 - val_loss: 1.5815 - val_accuracy: 0.5252
Using learning rate 0.0001
Epoch 5/15
10000/10000 [==============================] - 8s 810us/sample - loss: 0.6323 - accuracy: 0.8072 - val_loss: 1.5911 - val_accuracy: 0.5574
Using learning rate 0.0001
Epoch 6/15
10000/10000 [==============================] - 8s 810us/sample - loss: 0.5540 - accuracy: 0.8409 - val_loss: 1.8384 - val_accuracy: 0.5291
Using learning rate 0.0001
Epoch 7/15
10000/10000 [==============================] - 8s 809us/sample - loss: 0.4708 - accuracy: 0.8721 - val_loss: 1.8363 - val_accuracy: 0.5510
Using learning rate 0.0001
Epoch 8/15
10000/10000 [==============================] - 8s 811us/sample - loss: 0.4219 - accuracy: 0.8929 - val_loss: 1.9898 - val_accuracy: 0.5468
Using learning rate 0.0001
Epoch 9/15
10000/10000 [==============================] - 8s 809us/sample - loss: 0.3508 - accuracy: 0.9190 - val_loss: 2.2541 - val_accuracy: 0.5398
Using learning rate 0.0001
Epoch 10/15
10000/10000 [==============================] - 8s 809us/sample - loss: 0.3309 - accuracy: 0.9282 - val_loss: 2.2330 - val_accuracy: 0.5521
Using learning rate 0.0001
Epoch 11/15
10000/10000 [==============================] - 8s 810us/sample - loss: 0.3077 - accuracy: 0.9353 - val_loss: 2.3027 - val_accuracy: 0.5487
Using learning rate 0.0001
Epoch 12/15
10000/10000 [==============================] - 8s 811us/sample - loss: 0.2773 - accuracy: 0.9470 - val_loss: 2.3569 - val_accuracy: 0.5479
Using learning rate 0.0001
Epoch 13/15
10000/10000 [==============================] - 8s 812us/sample - loss: 0.2703 - accuracy: 0.9499 - val_loss: 2.3216 - val_accuracy: 0.5559
Using learning rate 0.0001
Epoch 14/15
10000/10000 [==============================] - 8s 811us/sample - loss: 0.2278 - accuracy: 0.9664 - val_loss: 2.5902 - val_accuracy: 0.5440
Using learning rate 0.0001
Epoch 15/15
10000/10000 [==============================] - 8s 809us/sample - loss: 0.2700 - accuracy: 0.9476 - val_loss: 2.4276 - val_accuracy: 0.5559
[fed-epoch 4] cid: 1
Train on 10000 samples, validate on 10000 samples
Using learning rate 0.0001
Epoch 1/15
10000/10000 [==============================] - 8s 811us/sample - loss: 0.3217 - accuracy: 0.9306 - val_loss: 3.1239 - val_accuracy: 0.5017
Using learning rate 0.0001
Epoch 2/15
10000/10000 [==============================] - 8s 810us/sample - loss: 0.2335 - accuracy: 0.9630 - val_loss: 3.2583 - val_accuracy: 0.5024
Using learning rate 0.0001
Epoch 3/15
10000/10000 [==============================] - 8s 809us/sample - loss: 0.2166 - accuracy: 0.9677 - val_loss: 3.2734 - val_accuracy: 0.5122
Using learning rate 0.0001
Epoch 4/15
10000/10000 [==============================] - 8s 808us/sample - loss: 0.2024 - accuracy: 0.9742 - val_loss: 3.4130 - val_accuracy: 0.5152
Using learning rate 0.0001
Epoch 5/15
10000/10000 [==============================] - 8s 808us/sample - loss: 0.2335 - accuracy: 0.9618 - val_loss: 3.2785 - val_accuracy: 0.4854
Using learning rate 0.0001
Epoch 6/15
10000/10000 [==============================] - 8s 811us/sample - loss: 0.1916 - accuracy: 0.9785 - val_loss: 3.4170 - val_accuracy: 0.5077
Using learning rate 0.0001
Epoch 7/15
10000/10000 [==============================] - 8s 810us/sample - loss: 0.1566 - accuracy: 0.9903 - val_loss: 3.7111 - val_accuracy: 0.4964
Using learning rate 0.0001
Epoch 8/15
10000/10000 [==============================] - 8s 808us/sample - loss: 0.2218 - accuracy: 0.9655 - val_loss: 3.3000 - val_accuracy: 0.5023
Using learning rate 0.0001
Epoch 9/15
10000/10000 [==============================] - 8s 809us/sample - loss: 0.2122 - accuracy: 0.9695 - val_loss: 3.5183 - val_accuracy: 0.5050
Using learning rate 0.0001
Epoch 10/15
10000/10000 [==============================] - 8s 809us/sample - loss: 0.1831 - accuracy: 0.9798 - val_loss: 3.5727 - val_accuracy: 0.5024
Using learning rate 0.0001
Epoch 11/15
10000/10000 [==============================] - 8s 810us/sample - loss: 0.1930 - accuracy: 0.9760 - val_loss: 3.5004 - val_accuracy: 0.5107
Using learning rate 0.0001
Epoch 12/15
10000/10000 [==============================] - 8s 810us/sample - loss: 0.2242 - accuracy: 0.9654 - val_loss: 3.3697 - val_accuracy: 0.5062
Using learning rate 0.0001
Epoch 13/15
10000/10000 [==============================] - 8s 810us/sample - loss: 0.1753 - accuracy: 0.9845 - val_loss: 3.5652 - val_accuracy: 0.5046
Using learning rate 0.0001
Epoch 14/15
10000/10000 [==============================] - 8s 810us/sample - loss: 0.1654 - accuracy: 0.9863 - val_loss: 3.4592 - val_accuracy: 0.5083
Using learning rate 0.0001
Epoch 15/15
10000/10000 [==============================] - 8s 808us/sample - loss: 0.2174 - accuracy: 0.9675 - val_loss: 3.4218 - val_accuracy: 0.5107
isolating attack on cid: 1 in fed-epoch: 4
Target model test accuracy 0.52
Epoch 0 over :Attack test accuracy: 0.5, Best accuracy : 0.5
Epoch 1 over :Attack test accuracy: 0.6783888936042786, Best accuracy : 0.6783888936042786
Epoch 2 over :Attack test accuracy: 0.742222249507904, Best accuracy : 0.742222249507904
Epoch 3 over :Attack test accuracy: 0.7599444389343262, Best accuracy : 0.7599444389343262
Epoch 4 over :Attack test accuracy: 0.7467222213745117, Best accuracy : 0.7599444389343262
Epoch 5 over :Attack test accuracy: 0.7476666569709778, Best accuracy : 0.7599444389343262
Epoch 6 over :Attack test accuracy: 0.7639444470405579, Best accuracy : 0.7639444470405579
Epoch 7 over :Attack test accuracy: 0.7638333439826965, Best accuracy : 0.7639444470405579
Epoch 8 over :Attack test accuracy: 0.7641666531562805, Best accuracy : 0.7641666531562805
Epoch 9 over :Attack test accuracy: 0.7589444518089294, Best accuracy : 0.7641666531562805
[fed-epoch 4] cid: 2
Train on 10000 samples, validate on 10000 samples
Using learning rate 0.0001
Epoch 1/15
10000/10000 [==============================] - 8s 812us/sample - loss: 1.2950 - accuracy: 0.5616 - val_loss: 1.3401 - val_accuracy: 0.5469
Using learning rate 0.0001
Epoch 2/15
10000/10000 [==============================] - 8s 810us/sample - loss: 1.0806 - accuracy: 0.6313 - val_loss: 1.3725 - val_accuracy: 0.5524
Using learning rate 0.0001
Epoch 3/15
10000/10000 [==============================] - 8s 809us/sample - loss: 0.9165 - accuracy: 0.6991 - val_loss: 1.3972 - val_accuracy: 0.5608
Using learning rate 0.0001
Epoch 4/15
10000/10000 [==============================] - 8s 811us/sample - loss: 0.7994 - accuracy: 0.7475 - val_loss: 1.5182 - val_accuracy: 0.5423
Using learning rate 0.0001
Epoch 5/15
10000/10000 [==============================] - 8s 811us/sample - loss: 0.6905 - accuracy: 0.7881 - val_loss: 1.5609 - val_accuracy: 0.5563
Using learning rate 0.0001
Epoch 6/15
10000/10000 [==============================] - 8s 811us/sample - loss: 0.5751 - accuracy: 0.8342 - val_loss: 1.6435 - val_accuracy: 0.5573
Using learning rate 0.0001
Epoch 7/15
10000/10000 [==============================] - 8s 810us/sample - loss: 0.4787 - accuracy: 0.8698 - val_loss: 1.8553 - val_accuracy: 0.5611
Using learning rate 0.0001
Epoch 8/15
10000/10000 [==============================] - 8s 809us/sample - loss: 0.4190 - accuracy: 0.8932 - val_loss: 2.1051 - val_accuracy: 0.5386
Using learning rate 0.0001
Epoch 9/15
10000/10000 [==============================] - 8s 810us/sample - loss: 0.3779 - accuracy: 0.9089 - val_loss: 2.0872 - val_accuracy: 0.5551
Using learning rate 0.0001
Epoch 10/15
10000/10000 [==============================] - 8s 811us/sample - loss: 0.3296 - accuracy: 0.9247 - val_loss: 2.2308 - val_accuracy: 0.5368
Using learning rate 0.0001
Epoch 11/15
10000/10000 [==============================] - 8s 811us/sample - loss: 0.2727 - accuracy: 0.9506 - val_loss: 2.3688 - val_accuracy: 0.5473
Using learning rate 0.0001
Epoch 12/15
10000/10000 [==============================] - 8s 809us/sample - loss: 0.2987 - accuracy: 0.9388 - val_loss: 2.3969 - val_accuracy: 0.5412
Using learning rate 0.0001
Epoch 13/15
10000/10000 [==============================] - 8s 810us/sample - loss: 0.2325 - accuracy: 0.9646 - val_loss: 2.5627 - val_accuracy: 0.5461
Using learning rate 0.0001
Epoch 14/15
10000/10000 [==============================] - 8s 810us/sample - loss: 0.2271 - accuracy: 0.9659 - val_loss: 2.4933 - val_accuracy: 0.5576
Using learning rate 0.0001
Epoch 15/15
10000/10000 [==============================] - 8s 809us/sample - loss: 0.2257 - accuracy: 0.9662 - val_loss: 2.7597 - val_accuracy: 0.5366
[fed-epoch 4] cid: 3
Train on 10000 samples, validate on 10000 samples
Using learning rate 0.0001
Epoch 1/15
10000/10000 [==============================] - 8s 812us/sample - loss: 1.2564 - accuracy: 0.5731 - val_loss: 1.2987 - val_accuracy: 0.5614
Using learning rate 0.0001
Epoch 2/15
10000/10000 [==============================] - 8s 809us/sample - loss: 1.0615 - accuracy: 0.6444 - val_loss: 1.3227 - val_accuracy: 0.5584
Using learning rate 0.0001
Epoch 3/15
10000/10000 [==============================] - 8s 809us/sample - loss: 0.9294 - accuracy: 0.6891 - val_loss: 1.3806 - val_accuracy: 0.5565
Using learning rate 0.0001
Epoch 4/15
10000/10000 [==============================] - 8s 808us/sample - loss: 0.8118 - accuracy: 0.7349 - val_loss: 1.4281 - val_accuracy: 0.5582
Using learning rate 0.0001
Epoch 5/15
10000/10000 [==============================] - 8s 810us/sample - loss: 0.6782 - accuracy: 0.7884 - val_loss: 1.5598 - val_accuracy: 0.5561
Using learning rate 0.0001
Epoch 6/15
10000/10000 [==============================] - 8s 811us/sample - loss: 0.6128 - accuracy: 0.8185 - val_loss: 1.6087 - val_accuracy: 0.5635
Using learning rate 0.0001
Epoch 7/15
10000/10000 [==============================] - 8s 808us/sample - loss: 0.5055 - accuracy: 0.8591 - val_loss: 1.9543 - val_accuracy: 0.5235
Using learning rate 0.0001
Epoch 8/15
10000/10000 [==============================] - 8s 810us/sample - loss: 0.4513 - accuracy: 0.8779 - val_loss: 1.8846 - val_accuracy: 0.5463
Using learning rate 0.0001
Epoch 9/15
10000/10000 [==============================] - 8s 810us/sample - loss: 0.3904 - accuracy: 0.9045 - val_loss: 2.0461 - val_accuracy: 0.5426
Using learning rate 0.0001
Epoch 10/15
10000/10000 [==============================] - 8s 810us/sample - loss: 0.3434 - accuracy: 0.9223 - val_loss: 2.0657 - val_accuracy: 0.5551
Using learning rate 0.0001
Epoch 11/15
10000/10000 [==============================] - 8s 810us/sample - loss: 0.2874 - accuracy: 0.9459 - val_loss: 2.3961 - val_accuracy: 0.5381
Using learning rate 0.0001
Epoch 12/15
10000/10000 [==============================] - 8s 810us/sample - loss: 0.2852 - accuracy: 0.9433 - val_loss: 2.4829 - val_accuracy: 0.5357
Using learning rate 0.0001
Epoch 13/15
10000/10000 [==============================] - 8s 811us/sample - loss: 0.2642 - accuracy: 0.9515 - val_loss: 2.3889 - val_accuracy: 0.5490
Using learning rate 0.0001
Epoch 14/15
10000/10000 [==============================] - 8s 811us/sample - loss: 0.2736 - accuracy: 0.9471 - val_loss: 2.4054 - val_accuracy: 0.5320
Using learning rate 0.0001
Epoch 15/15
10000/10000 [==============================] - 8s 811us/sample - loss: 0.2386 - accuracy: 0.9625 - val_loss: 2.4848 - val_accuracy: 0.5528
[fed-epoch 4] cid: 4
Train on 10000 samples, validate on 10000 samples
Using learning rate 0.0001
Epoch 1/15
10000/10000 [==============================] - 8s 811us/sample - loss: 1.2280 - accuracy: 0.5873 - val_loss: 1.3313 - val_accuracy: 0.5524
Using learning rate 0.0001
Epoch 2/15
10000/10000 [==============================] - 8s 809us/sample - loss: 1.0563 - accuracy: 0.6449 - val_loss: 1.3500 - val_accuracy: 0.5510
Using learning rate 0.0001
Epoch 3/15
10000/10000 [==============================] - 8s 809us/sample - loss: 0.9139 - accuracy: 0.6977 - val_loss: 1.3914 - val_accuracy: 0.5622
Using learning rate 0.0001
Epoch 4/15
10000/10000 [==============================] - 8s 808us/sample - loss: 0.7956 - accuracy: 0.7427 - val_loss: 1.5761 - val_accuracy: 0.5478
Using learning rate 0.0001
Epoch 5/15
10000/10000 [==============================] - 8s 810us/sample - loss: 0.7186 - accuracy: 0.7732 - val_loss: 1.6017 - val_accuracy: 0.5521
Using learning rate 0.0001
Epoch 6/15
10000/10000 [==============================] - 8s 810us/sample - loss: 0.5856 - accuracy: 0.8251 - val_loss: 1.7013 - val_accuracy: 0.5507
Using learning rate 0.0001
Epoch 7/15
10000/10000 [==============================] - 8s 810us/sample - loss: 0.5308 - accuracy: 0.8464 - val_loss: 1.8384 - val_accuracy: 0.5507
Using learning rate 0.0001
Epoch 8/15
10000/10000 [==============================] - 8s 809us/sample - loss: 0.4348 - accuracy: 0.8824 - val_loss: 1.8871 - val_accuracy: 0.5455
Using learning rate 0.0001
Epoch 9/15
10000/10000 [==============================] - 8s 809us/sample - loss: 0.3858 - accuracy: 0.9061 - val_loss: 2.0839 - val_accuracy: 0.5475
Using learning rate 0.0001
Epoch 10/15
10000/10000 [==============================] - 8s 809us/sample - loss: 0.3508 - accuracy: 0.9190 - val_loss: 2.2586 - val_accuracy: 0.5385
Using learning rate 0.0001
Epoch 11/15
10000/10000 [==============================] - 8s 812us/sample - loss: 0.3332 - accuracy: 0.9260 - val_loss: 2.2685 - val_accuracy: 0.5510
Using learning rate 0.0001
Epoch 12/15
10000/10000 [==============================] - 8s 809us/sample - loss: 0.2874 - accuracy: 0.9475 - val_loss: 2.4398 - val_accuracy: 0.5324
Using learning rate 0.0001
Epoch 13/15
10000/10000 [==============================] - 8s 809us/sample - loss: 0.2702 - accuracy: 0.9519 - val_loss: 2.4079 - val_accuracy: 0.5546
Using learning rate 0.0001
Epoch 14/15
10000/10000 [==============================] - 8s 810us/sample - loss: 0.2735 - accuracy: 0.9478 - val_loss: 2.4695 - val_accuracy: 0.5473
Using learning rate 0.0001
Epoch 15/15
10000/10000 [==============================] - 8s 809us/sample - loss: 0.2347 - accuracy: 0.9636 - val_loss: 2.7120 - val_accuracy: 0.5285
[fed-epoch 5] cid: 0
Train on 10000 samples, validate on 10000 samples
Using learning rate 0.0001
Epoch 1/15
10000/10000 [==============================] - 8s 814us/sample - loss: 1.1068 - accuracy: 0.6348 - val_loss: 1.3860 - val_accuracy: 0.5627
Using learning rate 0.0001
Epoch 2/15
10000/10000 [==============================] - 8s 811us/sample - loss: 0.8503 - accuracy: 0.7271 - val_loss: 1.3868 - val_accuracy: 0.5628
Using learning rate 0.0001
Epoch 3/15
10000/10000 [==============================] - 8s 808us/sample - loss: 0.6764 - accuracy: 0.7929 - val_loss: 1.5697 - val_accuracy: 0.5562
Using learning rate 0.0001
Epoch 4/15
10000/10000 [==============================] - 8s 810us/sample - loss: 0.5469 - accuracy: 0.8380 - val_loss: 1.6696 - val_accuracy: 0.5671
Using learning rate 0.0001
Epoch 5/15
10000/10000 [==============================] - 8s 809us/sample - loss: 0.4537 - accuracy: 0.8767 - val_loss: 1.9406 - val_accuracy: 0.5481
Using learning rate 0.0001
Epoch 6/15
10000/10000 [==============================] - 8s 810us/sample - loss: 0.3707 - accuracy: 0.9089 - val_loss: 2.0552 - val_accuracy: 0.5511
Using learning rate 0.0001
Epoch 7/15
10000/10000 [==============================] - 8s 810us/sample - loss: 0.3398 - accuracy: 0.9229 - val_loss: 2.1119 - val_accuracy: 0.5556
Using learning rate 0.0001
Epoch 8/15
10000/10000 [==============================] - 8s 810us/sample - loss: 0.2558 - accuracy: 0.9572 - val_loss: 2.4206 - val_accuracy: 0.5408
Using learning rate 0.0001
Epoch 9/15
10000/10000 [==============================] - 8s 810us/sample - loss: 0.2598 - accuracy: 0.9544 - val_loss: 2.3044 - val_accuracy: 0.5550
Using learning rate 0.0001
Epoch 10/15
10000/10000 [==============================] - 8s 810us/sample - loss: 0.2557 - accuracy: 0.9538 - val_loss: 2.4399 - val_accuracy: 0.5455
Using learning rate 0.0001
Epoch 11/15
10000/10000 [==============================] - 8s 811us/sample - loss: 0.2170 - accuracy: 0.9707 - val_loss: 2.5427 - val_accuracy: 0.5509
Using learning rate 0.0001
Epoch 12/15
10000/10000 [==============================] - 8s 810us/sample - loss: 0.2327 - accuracy: 0.9618 - val_loss: 2.5089 - val_accuracy: 0.5483
Using learning rate 0.0001
Epoch 13/15
10000/10000 [==============================] - 8s 809us/sample - loss: 0.2306 - accuracy: 0.9649 - val_loss: 2.4324 - val_accuracy: 0.5429
Using learning rate 0.0001
Epoch 14/15
10000/10000 [==============================] - 8s 810us/sample - loss: 0.2358 - accuracy: 0.9617 - val_loss: 2.6482 - val_accuracy: 0.5375
Using learning rate 0.0001
Epoch 15/15
10000/10000 [==============================] - 8s 810us/sample - loss: 0.1664 - accuracy: 0.9877 - val_loss: 2.6135 - val_accuracy: 0.5694
[fed-epoch 5] cid: 1
Train on 10000 samples, validate on 10000 samples
Using learning rate 0.0001
Epoch 1/15
10000/10000 [==============================] - 8s 809us/sample - loss: 0.2449 - accuracy: 0.9570 - val_loss: 3.5993 - val_accuracy: 0.4999
Using learning rate 0.0001
Epoch 2/15
10000/10000 [==============================] - 8s 809us/sample - loss: 0.1871 - accuracy: 0.9775 - val_loss: 3.6016 - val_accuracy: 0.4974
Using learning rate 0.0001
Epoch 3/15
10000/10000 [==============================] - 8s 809us/sample - loss: 0.1633 - accuracy: 0.9863 - val_loss: 3.5340 - val_accuracy: 0.4950
Using learning rate 0.0001
Epoch 4/15
10000/10000 [==============================] - 8s 810us/sample - loss: 0.1541 - accuracy: 0.9905 - val_loss: 3.5830 - val_accuracy: 0.5123
Using learning rate 0.0001
Epoch 5/15
10000/10000 [==============================] - 8s 810us/sample - loss: 0.1889 - accuracy: 0.9765 - val_loss: 3.5054 - val_accuracy: 0.4982
Using learning rate 0.0001
Epoch 6/15
10000/10000 [==============================] - 8s 810us/sample - loss: 0.1649 - accuracy: 0.9847 - val_loss: 3.5875 - val_accuracy: 0.5104
Using learning rate 0.0001
Epoch 7/15
10000/10000 [==============================] - 8s 810us/sample - loss: 0.2077 - accuracy: 0.9700 - val_loss: 3.3758 - val_accuracy: 0.5095
Using learning rate 0.0001
Epoch 8/15
10000/10000 [==============================] - 8s 809us/sample - loss: 0.1385 - accuracy: 0.9937 - val_loss: 3.5377 - val_accuracy: 0.5180
Using learning rate 0.0001
Epoch 9/15
10000/10000 [==============================] - 8s 810us/sample - loss: 0.1755 - accuracy: 0.9813 - val_loss: 3.5660 - val_accuracy: 0.4984
Using learning rate 0.0001
Epoch 10/15
10000/10000 [==============================] - 8s 807us/sample - loss: 0.1597 - accuracy: 0.9861 - val_loss: 3.4848 - val_accuracy: 0.5102
Using learning rate 0.0001
Epoch 11/15
10000/10000 [==============================] - 8s 809us/sample - loss: 0.1374 - accuracy: 0.9927 - val_loss: 3.7986 - val_accuracy: 0.5007
Using learning rate 0.0001
Epoch 12/15
10000/10000 [==============================] - 8s 810us/sample - loss: 0.2012 - accuracy: 0.9695 - val_loss: 3.2006 - val_accuracy: 0.5169
Using learning rate 0.0001
Epoch 13/15
10000/10000 [==============================] - 8s 810us/sample - loss: 0.1610 - accuracy: 0.9856 - val_loss: 3.8604 - val_accuracy: 0.4920
Using learning rate 0.0001
Epoch 14/15
10000/10000 [==============================] - 8s 808us/sample - loss: 0.1715 - accuracy: 0.9810 - val_loss: 3.5011 - val_accuracy: 0.5200
Using learning rate 0.0001
Epoch 15/15
10000/10000 [==============================] - 8s 808us/sample - loss: 0.1384 - accuracy: 0.9935 - val_loss: 3.5956 - val_accuracy: 0.5170
[fed-epoch 5] cid: 2
Train on 10000 samples, validate on 10000 samples
Using learning rate 0.0001
Epoch 1/15
10000/10000 [==============================] - 8s 812us/sample - loss: 1.2222 - accuracy: 0.5937 - val_loss: 1.3363 - val_accuracy: 0.5540
Using learning rate 0.0001
Epoch 2/15
10000/10000 [==============================] - 8s 809us/sample - loss: 0.9421 - accuracy: 0.6926 - val_loss: 1.4657 - val_accuracy: 0.5479
Using learning rate 0.0001
Epoch 3/15
10000/10000 [==============================] - 8s 810us/sample - loss: 0.7505 - accuracy: 0.7663 - val_loss: 1.4681 - val_accuracy: 0.5649
Using learning rate 0.0001
Epoch 4/15
10000/10000 [==============================] - 8s 810us/sample - loss: 0.6061 - accuracy: 0.8183 - val_loss: 1.6822 - val_accuracy: 0.5475
Using learning rate 0.0001
Epoch 5/15
10000/10000 [==============================] - 8s 812us/sample - loss: 0.4917 - accuracy: 0.8646 - val_loss: 1.7879 - val_accuracy: 0.5576
Using learning rate 0.0001
Epoch 6/15
10000/10000 [==============================] - 8s 810us/sample - loss: 0.3907 - accuracy: 0.9040 - val_loss: 2.1180 - val_accuracy: 0.5543
Using learning rate 0.0001
Epoch 7/15
10000/10000 [==============================] - 8s 810us/sample - loss: 0.3584 - accuracy: 0.9173 - val_loss: 2.0723 - val_accuracy: 0.5509
Using learning rate 0.0001
Epoch 8/15
10000/10000 [==============================] - 8s 810us/sample - loss: 0.2835 - accuracy: 0.9471 - val_loss: 2.3432 - val_accuracy: 0.5451
Using learning rate 0.0001
Epoch 9/15
10000/10000 [==============================] - 8s 810us/sample - loss: 0.2529 - accuracy: 0.9558 - val_loss: 2.3395 - val_accuracy: 0.5573
Using learning rate 0.0001
Epoch 10/15
10000/10000 [==============================] - 8s 809us/sample - loss: 0.2587 - accuracy: 0.9519 - val_loss: 2.4167 - val_accuracy: 0.5617
Using learning rate 0.0001
Epoch 11/15
10000/10000 [==============================] - 8s 810us/sample - loss: 0.2106 - accuracy: 0.9711 - val_loss: 2.5400 - val_accuracy: 0.5623
Using learning rate 0.0001
Epoch 12/15
10000/10000 [==============================] - 8s 810us/sample - loss: 0.2087 - accuracy: 0.9707 - val_loss: 2.5852 - val_accuracy: 0.5682
Using learning rate 0.0001
Epoch 13/15
10000/10000 [==============================] - 8s 809us/sample - loss: 0.2411 - accuracy: 0.9579 - val_loss: 2.5129 - val_accuracy: 0.5653
Using learning rate 0.0001
Epoch 14/15
10000/10000 [==============================] - 8s 811us/sample - loss: 0.2092 - accuracy: 0.9732 - val_loss: 2.5733 - val_accuracy: 0.5471
Using learning rate 0.0001
Epoch 15/15
10000/10000 [==============================] - 8s 810us/sample - loss: 0.1764 - accuracy: 0.9825 - val_loss: 2.7297 - val_accuracy: 0.5653
[fed-epoch 5] cid: 3
Train on 10000 samples, validate on 10000 samples
Using learning rate 0.0001
Epoch 1/15
10000/10000 [==============================] - 8s 811us/sample - loss: 1.1923 - accuracy: 0.6065 - val_loss: 1.3267 - val_accuracy: 0.5623
Using learning rate 0.0001
Epoch 2/15
10000/10000 [==============================] - 8s 810us/sample - loss: 0.9292 - accuracy: 0.6986 - val_loss: 1.4606 - val_accuracy: 0.5519
Using learning rate 0.0001
Epoch 3/15
10000/10000 [==============================] - 8s 811us/sample - loss: 0.7525 - accuracy: 0.7610 - val_loss: 1.4988 - val_accuracy: 0.5638
Using learning rate 0.0001
Epoch 4/15
10000/10000 [==============================] - 8s 809us/sample - loss: 0.6071 - accuracy: 0.8164 - val_loss: 1.6280 - val_accuracy: 0.5554
Using learning rate 0.0001
Epoch 5/15
10000/10000 [==============================] - 8s 809us/sample - loss: 0.4781 - accuracy: 0.8700 - val_loss: 1.9620 - val_accuracy: 0.5333
Using learning rate 0.0001
Epoch 6/15
10000/10000 [==============================] - 8s 810us/sample - loss: 0.3988 - accuracy: 0.8984 - val_loss: 1.9339 - val_accuracy: 0.5567
Using learning rate 0.0001
Epoch 7/15
10000/10000 [==============================] - 8s 810us/sample - loss: 0.3418 - accuracy: 0.9209 - val_loss: 2.1658 - val_accuracy: 0.5402
Using learning rate 0.0001
Epoch 8/15
10000/10000 [==============================] - 8s 810us/sample - loss: 0.2972 - accuracy: 0.9390 - val_loss: 2.1754 - val_accuracy: 0.5647
Using learning rate 0.0001
Epoch 9/15
10000/10000 [==============================] - 8s 811us/sample - loss: 0.2813 - accuracy: 0.9441 - val_loss: 2.2643 - val_accuracy: 0.5449
Using learning rate 0.0001
Epoch 10/15
10000/10000 [==============================] - 8s 809us/sample - loss: 0.2499 - accuracy: 0.9592 - val_loss: 2.3152 - val_accuracy: 0.5690
Using learning rate 0.0001
Epoch 11/15
10000/10000 [==============================] - 8s 810us/sample - loss: 0.2254 - accuracy: 0.9673 - val_loss: 2.5038 - val_accuracy: 0.5534
Using learning rate 0.0001
Epoch 12/15
10000/10000 [==============================] - 8s 812us/sample - loss: 0.2442 - accuracy: 0.9574 - val_loss: 2.3030 - val_accuracy: 0.5539
Using learning rate 0.0001
Epoch 13/15
10000/10000 [==============================] - 8s 810us/sample - loss: 0.2268 - accuracy: 0.9635 - val_loss: 2.5262 - val_accuracy: 0.5508
Using learning rate 0.0001
Epoch 14/15
10000/10000 [==============================] - 8s 809us/sample - loss: 0.1763 - accuracy: 0.9827 - val_loss: 2.6577 - val_accuracy: 0.5556
Using learning rate 0.0001
Epoch 15/15
10000/10000 [==============================] - 8s 809us/sample - loss: 0.2020 - accuracy: 0.9737 - val_loss: 2.6350 - val_accuracy: 0.5492
[fed-epoch 5] cid: 4
Train on 10000 samples, validate on 10000 samples
Using learning rate 0.0001
Epoch 1/15
10000/10000 [==============================] - 8s 811us/sample - loss: 1.1530 - accuracy: 0.6275 - val_loss: 1.3297 - val_accuracy: 0.5714
Using learning rate 0.0001
Epoch 2/15
10000/10000 [==============================] - 8s 811us/sample - loss: 0.8954 - accuracy: 0.7099 - val_loss: 1.3603 - val_accuracy: 0.5709
Using learning rate 0.0001
Epoch 3/15
10000/10000 [==============================] - 8s 810us/sample - loss: 0.7204 - accuracy: 0.7762 - val_loss: 1.6037 - val_accuracy: 0.5491
Using learning rate 0.0001
Epoch 4/15
10000/10000 [==============================] - 8s 810us/sample - loss: 0.5868 - accuracy: 0.8278 - val_loss: 1.6074 - val_accuracy: 0.5676
Using learning rate 0.0001
Epoch 5/15
10000/10000 [==============================] - 8s 809us/sample - loss: 0.4579 - accuracy: 0.8794 - val_loss: 1.8783 - val_accuracy: 0.5496
Using learning rate 0.0001
Epoch 6/15
10000/10000 [==============================] - 8s 810us/sample - loss: 0.3862 - accuracy: 0.9050 - val_loss: 2.0484 - val_accuracy: 0.5456
Using learning rate 0.0001
Epoch 7/15
10000/10000 [==============================] - 8s 810us/sample - loss: 0.3367 - accuracy: 0.9246 - val_loss: 2.0631 - val_accuracy: 0.5596
Using learning rate 0.0001
Epoch 8/15
10000/10000 [==============================] - 8s 809us/sample - loss: 0.2958 - accuracy: 0.9391 - val_loss: 2.2544 - val_accuracy: 0.5537
Using learning rate 0.0001
Epoch 9/15
10000/10000 [==============================] - 8s 811us/sample - loss: 0.2567 - accuracy: 0.9546 - val_loss: 2.3504 - val_accuracy: 0.5597
Using learning rate 0.0001
Epoch 10/15
10000/10000 [==============================] - 8s 809us/sample - loss: 0.2497 - accuracy: 0.9568 - val_loss: 2.4087 - val_accuracy: 0.5560
Using learning rate 0.0001
Epoch 11/15
10000/10000 [==============================] - 8s 811us/sample - loss: 0.2469 - accuracy: 0.9592 - val_loss: 2.4702 - val_accuracy: 0.5544
Using learning rate 0.0001
Epoch 12/15
10000/10000 [==============================] - 8s 809us/sample - loss: 0.2235 - accuracy: 0.9666 - val_loss: 2.4869 - val_accuracy: 0.5583
Using learning rate 0.0001
Epoch 13/15
10000/10000 [==============================] - 8s 809us/sample - loss: 0.2160 - accuracy: 0.9686 - val_loss: 2.5325 - val_accuracy: 0.5579
Using learning rate 0.0001
Epoch 14/15
10000/10000 [==============================] - 8s 809us/sample - loss: 0.1974 - accuracy: 0.9758 - val_loss: 2.6840 - val_accuracy: 0.5552
Using learning rate 0.0001
Epoch 15/15
10000/10000 [==============================] - 8s 813us/sample - loss: 0.2170 - accuracy: 0.9667 - val_loss: 2.4299 - val_accuracy: 0.5650
[fed-epoch 6] cid: 0
Train on 10000 samples, validate on 10000 samples
Using learning rate 0.0001
Epoch 1/15
10000/10000 [==============================] - 8s 813us/sample - loss: 1.0541 - accuracy: 0.6615 - val_loss: 1.3429 - val_accuracy: 0.5751
Using learning rate 0.0001
Epoch 2/15
10000/10000 [==============================] - 8s 812us/sample - loss: 0.7576 - accuracy: 0.7627 - val_loss: 1.4539 - val_accuracy: 0.5711
Using learning rate 0.0001
Epoch 3/15
10000/10000 [==============================] - 8s 809us/sample - loss: 0.5539 - accuracy: 0.8397 - val_loss: 1.6482 - val_accuracy: 0.5700
Using learning rate 0.0001
Epoch 4/15
10000/10000 [==============================] - 8s 809us/sample - loss: 0.4240 - accuracy: 0.8883 - val_loss: 1.8645 - val_accuracy: 0.5668
Using learning rate 0.0001
Epoch 5/15
10000/10000 [==============================] - 8s 811us/sample - loss: 0.3718 - accuracy: 0.9089 - val_loss: 1.9652 - val_accuracy: 0.5585
Using learning rate 0.0001
Epoch 6/15
10000/10000 [==============================] - 8s 810us/sample - loss: 0.2847 - accuracy: 0.9407 - val_loss: 2.4199 - val_accuracy: 0.5353
Using learning rate 0.0001
Epoch 7/15
10000/10000 [==============================] - 8s 809us/sample - loss: 0.2598 - accuracy: 0.9521 - val_loss: 2.3179 - val_accuracy: 0.5436
Using learning rate 0.0001
Epoch 8/15
10000/10000 [==============================] - 8s 811us/sample - loss: 0.2658 - accuracy: 0.9508 - val_loss: 2.2620 - val_accuracy: 0.5691
Using learning rate 0.0001
Epoch 9/15
10000/10000 [==============================] - 8s 810us/sample - loss: 0.2126 - accuracy: 0.9707 - val_loss: 2.3837 - val_accuracy: 0.5637
Using learning rate 0.0001
Epoch 10/15
10000/10000 [==============================] - 8s 810us/sample - loss: 0.2213 - accuracy: 0.9660 - val_loss: 2.3575 - val_accuracy: 0.5521
Using learning rate 0.0001
Epoch 11/15
10000/10000 [==============================] - 8s 809us/sample - loss: 0.2170 - accuracy: 0.9656 - val_loss: 2.5506 - val_accuracy: 0.5662
Using learning rate 0.0001
Epoch 12/15
10000/10000 [==============================] - 8s 809us/sample - loss: 0.2008 - accuracy: 0.9732 - val_loss: 2.6432 - val_accuracy: 0.5539
Using learning rate 0.0001
Epoch 13/15
10000/10000 [==============================] - 8s 809us/sample - loss: 0.2011 - accuracy: 0.9727 - val_loss: 2.5755 - val_accuracy: 0.5509
Using learning rate 0.0001
Epoch 14/15
10000/10000 [==============================] - 8s 811us/sample - loss: 0.1838 - accuracy: 0.9788 - val_loss: 2.6182 - val_accuracy: 0.5530
Using learning rate 0.0001
Epoch 15/15
10000/10000 [==============================] - 8s 810us/sample - loss: 0.2083 - accuracy: 0.9715 - val_loss: 2.7696 - val_accuracy: 0.5401
[fed-epoch 6] cid: 1
Train on 10000 samples, validate on 10000 samples
Using learning rate 0.0001
Epoch 1/15
10000/10000 [==============================] - 8s 811us/sample - loss: 0.1596 - accuracy: 0.9846 - val_loss: 3.6279 - val_accuracy: 0.5118
Using learning rate 0.0001
Epoch 2/15
10000/10000 [==============================] - 8s 810us/sample - loss: 0.1829 - accuracy: 0.9746 - val_loss: 3.6792 - val_accuracy: 0.4977
Using learning rate 0.0001
Epoch 3/15
10000/10000 [==============================] - 8s 810us/sample - loss: 0.1389 - accuracy: 0.9932 - val_loss: 3.6441 - val_accuracy: 0.5176
Using learning rate 0.0001
Epoch 4/15
10000/10000 [==============================] - 8s 810us/sample - loss: 0.1277 - accuracy: 0.9953 - val_loss: 3.6744 - val_accuracy: 0.5102
Using learning rate 0.0001
Epoch 5/15
10000/10000 [==============================] - 8s 810us/sample - loss: 0.1782 - accuracy: 0.9798 - val_loss: 3.1776 - val_accuracy: 0.4873
Using learning rate 0.0001
Epoch 6/15
10000/10000 [==============================] - 8s 810us/sample - loss: 0.1484 - accuracy: 0.9887 - val_loss: 3.5698 - val_accuracy: 0.5103
Using learning rate 0.0001
Epoch 7/15
10000/10000 [==============================] - 8s 809us/sample - loss: 0.1248 - accuracy: 0.9966 - val_loss: 3.7100 - val_accuracy: 0.5162
Using learning rate 0.0001
Epoch 8/15
10000/10000 [==============================] - 8s 810us/sample - loss: 0.1128 - accuracy: 0.9991 - val_loss: 3.6849 - val_accuracy: 0.5155
Using learning rate 0.0001
Epoch 9/15
10000/10000 [==============================] - 8s 811us/sample - loss: 0.1186 - accuracy: 0.9961 - val_loss: 3.4708 - val_accuracy: 0.5060
Using learning rate 0.0001
Epoch 10/15
10000/10000 [==============================] - 8s 809us/sample - loss: 0.2143 - accuracy: 0.9648 - val_loss: 3.2555 - val_accuracy: 0.5008
Using learning rate 0.0001
Epoch 11/15
10000/10000 [==============================] - 8s 809us/sample - loss: 0.1576 - accuracy: 0.9835 - val_loss: 3.5649 - val_accuracy: 0.5010
Using learning rate 0.0001
Epoch 12/15
10000/10000 [==============================] - 8s 810us/sample - loss: 0.1620 - accuracy: 0.9840 - val_loss: 3.4350 - val_accuracy: 0.5082
Using learning rate 0.0001
Epoch 13/15
10000/10000 [==============================] - 8s 809us/sample - loss: 0.1275 - accuracy: 0.9931 - val_loss: 3.5861 - val_accuracy: 0.4927
Using learning rate 0.0001
Epoch 14/15
10000/10000 [==============================] - 8s 811us/sample - loss: 0.1801 - accuracy: 0.9758 - val_loss: 3.3926 - val_accuracy: 0.5023
Using learning rate 0.0001
Epoch 15/15
10000/10000 [==============================] - 8s 811us/sample - loss: 0.1407 - accuracy: 0.9897 - val_loss: 3.5926 - val_accuracy: 0.5101
isolating attack on cid: 1 in fed-epoch: 6
Target model test accuracy 0.525
Epoch 0 over :Attack test accuracy: 0.7708888649940491, Best accuracy : 0.7708888649940491
Epoch 1 over :Attack test accuracy: 0.519944429397583, Best accuracy : 0.7708888649940491
Epoch 2 over :Attack test accuracy: 0.7842777967453003, Best accuracy : 0.7842777967453003
Epoch 3 over :Attack test accuracy: 0.7812777757644653, Best accuracy : 0.7842777967453003
Epoch 4 over :Attack test accuracy: 0.7877222299575806, Best accuracy : 0.7877222299575806
Epoch 5 over :Attack test accuracy: 0.7890555262565613, Best accuracy : 0.7890555262565613
Epoch 6 over :Attack test accuracy: 0.7988888621330261, Best accuracy : 0.7988888621330261
Epoch 7 over :Attack test accuracy: 0.7794444561004639, Best accuracy : 0.7988888621330261
Epoch 8 over :Attack test accuracy: 0.789722204208374, Best accuracy : 0.7988888621330261
Epoch 9 over :Attack test accuracy: 0.7821666598320007, Best accuracy : 0.7988888621330261
[fed-epoch 6] cid: 2
Train on 10000 samples, validate on 10000 samples
Using learning rate 0.0001
Epoch 1/15
10000/10000 [==============================] - 8s 812us/sample - loss: 1.1697 - accuracy: 0.6122 - val_loss: 1.3336 - val_accuracy: 0.5678
Using learning rate 0.0001
Epoch 2/15
10000/10000 [==============================] - 8s 809us/sample - loss: 0.8282 - accuracy: 0.7366 - val_loss: 1.4224 - val_accuracy: 0.5715
Using learning rate 0.0001
Epoch 3/15
10000/10000 [==============================] - 8s 809us/sample - loss: 0.6217 - accuracy: 0.8082 - val_loss: 1.6958 - val_accuracy: 0.5509
Using learning rate 0.0001
Epoch 4/15
10000/10000 [==============================] - 8s 809us/sample - loss: 0.4625 - accuracy: 0.8711 - val_loss: 1.7264 - val_accuracy: 0.5701
Using learning rate 0.0001
Epoch 5/15
10000/10000 [==============================] - 8s 811us/sample - loss: 0.3704 - accuracy: 0.9076 - val_loss: 1.9673 - val_accuracy: 0.5652
Using learning rate 0.0001
Epoch 6/15
10000/10000 [==============================] - 8s 811us/sample - loss: 0.2924 - accuracy: 0.9391 - val_loss: 2.2443 - val_accuracy: 0.5500
Using learning rate 0.0001
Epoch 7/15
10000/10000 [==============================] - 8s 811us/sample - loss: 0.2413 - accuracy: 0.9594 - val_loss: 2.4085 - val_accuracy: 0.5536
Using learning rate 0.0001
Epoch 8/15
10000/10000 [==============================] - 8s 810us/sample - loss: 0.2256 - accuracy: 0.9634 - val_loss: 2.4186 - val_accuracy: 0.5678
Using learning rate 0.0001
Epoch 9/15
10000/10000 [==============================] - 8s 810us/sample - loss: 0.2131 - accuracy: 0.9696 - val_loss: 2.5922 - val_accuracy: 0.5476
Using learning rate 0.0001
Epoch 10/15
10000/10000 [==============================] - 8s 809us/sample - loss: 0.2248 - accuracy: 0.9646 - val_loss: 2.5737 - val_accuracy: 0.5549
Using learning rate 0.0001
Epoch 11/15
10000/10000 [==============================] - 8s 810us/sample - loss: 0.1892 - accuracy: 0.9781 - val_loss: 2.5805 - val_accuracy: 0.5668
Using learning rate 0.0001
Epoch 12/15
10000/10000 [==============================] - 8s 811us/sample - loss: 0.1946 - accuracy: 0.9760 - val_loss: 2.6490 - val_accuracy: 0.5585
Using learning rate 0.0001
Epoch 13/15
10000/10000 [==============================] - 8s 809us/sample - loss: 0.1828 - accuracy: 0.9795 - val_loss: 2.6639 - val_accuracy: 0.5639
Using learning rate 0.0001
Epoch 14/15
10000/10000 [==============================] - 8s 811us/sample - loss: 0.2045 - accuracy: 0.9716 - val_loss: 2.4940 - val_accuracy: 0.5645
Using learning rate 0.0001
Epoch 15/15
10000/10000 [==============================] - 8s 810us/sample - loss: 0.1596 - accuracy: 0.9870 - val_loss: 2.8816 - val_accuracy: 0.5584
[fed-epoch 6] cid: 3
Train on 10000 samples, validate on 10000 samples
Using learning rate 0.0001
Epoch 1/15
10000/10000 [==============================] - 8s 811us/sample - loss: 1.1297 - accuracy: 0.6353 - val_loss: 1.3089 - val_accuracy: 0.5804
Using learning rate 0.0001
Epoch 2/15
10000/10000 [==============================] - 8s 810us/sample - loss: 0.8057 - accuracy: 0.7463 - val_loss: 1.4459 - val_accuracy: 0.5639
Using learning rate 0.0001
Epoch 3/15
10000/10000 [==============================] - 8s 809us/sample - loss: 0.6078 - accuracy: 0.8182 - val_loss: 1.6733 - val_accuracy: 0.5530
Using learning rate 0.0001
Epoch 4/15
10000/10000 [==============================] - 8s 810us/sample - loss: 0.4564 - accuracy: 0.8763 - val_loss: 2.0004 - val_accuracy: 0.5427
Using learning rate 0.0001
Epoch 5/15
10000/10000 [==============================] - 8s 810us/sample - loss: 0.3826 - accuracy: 0.9033 - val_loss: 1.9037 - val_accuracy: 0.5576
Using learning rate 0.0001
Epoch 6/15
10000/10000 [==============================] - 8s 810us/sample - loss: 0.2809 - accuracy: 0.9447 - val_loss: 2.2082 - val_accuracy: 0.5424
Using learning rate 0.0001
Epoch 7/15
10000/10000 [==============================] - 8s 809us/sample - loss: 0.2763 - accuracy: 0.9455 - val_loss: 2.3783 - val_accuracy: 0.5508
Using learning rate 0.0001
Epoch 8/15
10000/10000 [==============================] - 8s 810us/sample - loss: 0.2481 - accuracy: 0.9563 - val_loss: 2.3502 - val_accuracy: 0.5540
Using learning rate 0.0001
Epoch 9/15
10000/10000 [==============================] - 8s 809us/sample - loss: 0.2485 - accuracy: 0.9534 - val_loss: 2.3716 - val_accuracy: 0.5498
Using learning rate 0.0001
Epoch 10/15
10000/10000 [==============================] - 8s 809us/sample - loss: 0.2033 - accuracy: 0.9734 - val_loss: 2.4653 - val_accuracy: 0.5653
Using learning rate 0.0001
Epoch 11/15
10000/10000 [==============================] - 8s 810us/sample - loss: 0.1824 - accuracy: 0.9819 - val_loss: 2.5140 - val_accuracy: 0.5647
Using learning rate 0.0001
Epoch 12/15
10000/10000 [==============================] - 8s 809us/sample - loss: 0.1723 - accuracy: 0.9827 - val_loss: 2.7058 - val_accuracy: 0.5611
Using learning rate 0.0001
Epoch 13/15
10000/10000 [==============================] - 8s 810us/sample - loss: 0.2449 - accuracy: 0.9564 - val_loss: 2.5433 - val_accuracy: 0.5556
Using learning rate 0.0001
Epoch 14/15
10000/10000 [==============================] - 8s 809us/sample - loss: 0.1806 - accuracy: 0.9798 - val_loss: 2.6163 - val_accuracy: 0.5550
Using learning rate 0.0001
Epoch 15/15
10000/10000 [==============================] - 8s 808us/sample - loss: 0.1887 - accuracy: 0.9762 - val_loss: 2.6353 - val_accuracy: 0.5596
[fed-epoch 6] cid: 4
Train on 10000 samples, validate on 10000 samples
Using learning rate 0.0001
Epoch 1/15
10000/10000 [==============================] - 8s 811us/sample - loss: 1.0859 - accuracy: 0.6498 - val_loss: 1.4145 - val_accuracy: 0.5553
Using learning rate 0.0001
Epoch 2/15
10000/10000 [==============================] - 8s 810us/sample - loss: 0.7824 - accuracy: 0.7519 - val_loss: 1.5318 - val_accuracy: 0.5567
Using learning rate 0.0001
Epoch 3/15
10000/10000 [==============================] - 8s 811us/sample - loss: 0.5807 - accuracy: 0.8292 - val_loss: 1.7066 - val_accuracy: 0.5571
Using learning rate 0.0001
Epoch 4/15
10000/10000 [==============================] - 8s 810us/sample - loss: 0.4463 - accuracy: 0.8811 - val_loss: 1.8078 - val_accuracy: 0.5688
Using learning rate 0.0001
Epoch 5/15
10000/10000 [==============================] - 8s 810us/sample - loss: 0.3623 - accuracy: 0.9103 - val_loss: 1.8935 - val_accuracy: 0.5686
Using learning rate 0.0001
Epoch 6/15
10000/10000 [==============================] - 8s 810us/sample - loss: 0.3041 - accuracy: 0.9350 - val_loss: 2.0383 - val_accuracy: 0.5683
Using learning rate 0.0001
Epoch 7/15
10000/10000 [==============================] - 8s 811us/sample - loss: 0.2660 - accuracy: 0.9529 - val_loss: 2.2815 - val_accuracy: 0.5639
Using learning rate 0.0001
Epoch 8/15
10000/10000 [==============================] - 8s 809us/sample - loss: 0.2306 - accuracy: 0.9630 - val_loss: 2.3902 - val_accuracy: 0.5614
Using learning rate 0.0001
Epoch 9/15
10000/10000 [==============================] - 8s 810us/sample - loss: 0.2339 - accuracy: 0.9631 - val_loss: 2.4897 - val_accuracy: 0.5459
Using learning rate 0.0001
Epoch 10/15
10000/10000 [==============================] - 8s 810us/sample - loss: 0.2037 - accuracy: 0.9730 - val_loss: 2.7247 - val_accuracy: 0.5461
Using learning rate 0.0001
Epoch 11/15
10000/10000 [==============================] - 8s 812us/sample - loss: 0.1983 - accuracy: 0.9729 - val_loss: 2.6818 - val_accuracy: 0.5534
Using learning rate 0.0001
Epoch 12/15
10000/10000 [==============================] - 8s 812us/sample - loss: 0.2083 - accuracy: 0.9694 - val_loss: 2.5682 - val_accuracy: 0.5549
Using learning rate 0.0001
Epoch 13/15
10000/10000 [==============================] - 8s 812us/sample - loss: 0.2150 - accuracy: 0.9696 - val_loss: 2.5898 - val_accuracy: 0.5603
Using learning rate 0.0001
Epoch 14/15
10000/10000 [==============================] - 8s 810us/sample - loss: 0.1944 - accuracy: 0.9749 - val_loss: 2.6255 - val_accuracy: 0.5644
Using learning rate 0.0001
Epoch 15/15
10000/10000 [==============================] - 8s 808us/sample - loss: 0.1858 - accuracy: 0.9780 - val_loss: 2.6513 - val_accuracy: 0.5587
