Dataset: train-50000, test-10000
[fed-epoch 0] cid: 0
Using learning rate 0.0001
Epoch 1/15
2021-01-04 16:45:31.713908: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10
2021-01-04 16:45:31.947261: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
391/391 [==============================] - 5s 13ms/step - loss: 2.1152 - accuracy: 0.1949 - val_loss: 1.9529 - val_accuracy: 0.2366 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 2/15
391/391 [==============================] - 5s 12ms/step - loss: 1.8931 - accuracy: 0.2690 - val_loss: 1.8739 - val_accuracy: 0.2756 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 3/15
391/391 [==============================] - 5s 12ms/step - loss: 1.8066 - accuracy: 0.3134 - val_loss: 1.7845 - val_accuracy: 0.3257 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 4/15
391/391 [==============================] - 5s 12ms/step - loss: 1.7301 - accuracy: 0.3482 - val_loss: 1.6856 - val_accuracy: 0.3822 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 5/15
391/391 [==============================] - 5s 12ms/step - loss: 1.6594 - accuracy: 0.3881 - val_loss: 1.6169 - val_accuracy: 0.4089 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 6/15
391/391 [==============================] - 5s 12ms/step - loss: 1.5710 - accuracy: 0.4191 - val_loss: 1.5749 - val_accuracy: 0.4237 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 7/15
391/391 [==============================] - 5s 12ms/step - loss: 1.5068 - accuracy: 0.4518 - val_loss: 1.4945 - val_accuracy: 0.4651 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 8/15
391/391 [==============================] - 5s 12ms/step - loss: 1.4359 - accuracy: 0.4839 - val_loss: 1.5144 - val_accuracy: 0.4636 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 9/15
391/391 [==============================] - 5s 12ms/step - loss: 1.3566 - accuracy: 0.5194 - val_loss: 1.4700 - val_accuracy: 0.4862 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 10/15
391/391 [==============================] - 5s 12ms/step - loss: 1.2926 - accuracy: 0.5467 - val_loss: 1.4549 - val_accuracy: 0.5031 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 11/15
391/391 [==============================] - 5s 12ms/step - loss: 1.2282 - accuracy: 0.5681 - val_loss: 1.4419 - val_accuracy: 0.5177 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 12/15
391/391 [==============================] - 5s 12ms/step - loss: 1.1704 - accuracy: 0.5947 - val_loss: 1.4018 - val_accuracy: 0.5221 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 13/15
391/391 [==============================] - 5s 12ms/step - loss: 1.1079 - accuracy: 0.6181 - val_loss: 1.5326 - val_accuracy: 0.5000 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 14/15
391/391 [==============================] - 5s 12ms/step - loss: 1.0435 - accuracy: 0.6441 - val_loss: 1.4910 - val_accuracy: 0.5152 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 15/15
391/391 [==============================] - 5s 12ms/step - loss: 0.9939 - accuracy: 0.6650 - val_loss: 1.5339 - val_accuracy: 0.5234 - lr: 1.0000e-04
[fed-epoch 0] cid: 1
Using learning rate 0.0001
Epoch 1/15
391/391 [==============================] - 5s 12ms/step - loss: 2.0575 - accuracy: 0.1758 - val_loss: 1.9453 - val_accuracy: 0.2325 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 2/15
391/391 [==============================] - 5s 12ms/step - loss: 1.8544 - accuracy: 0.2622 - val_loss: 1.8052 - val_accuracy: 0.2884 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 3/15
391/391 [==============================] - 5s 12ms/step - loss: 1.7474 - accuracy: 0.3135 - val_loss: 1.7163 - val_accuracy: 0.3284 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 4/15
391/391 [==============================] - 5s 12ms/step - loss: 1.6983 - accuracy: 0.3396 - val_loss: 1.6700 - val_accuracy: 0.3562 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 5/15
391/391 [==============================] - 5s 12ms/step - loss: 1.6343 - accuracy: 0.3715 - val_loss: 1.6592 - val_accuracy: 0.3771 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 6/15
391/391 [==============================] - 5s 12ms/step - loss: 1.5795 - accuracy: 0.4068 - val_loss: 1.6092 - val_accuracy: 0.4025 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 7/15
391/391 [==============================] - 5s 12ms/step - loss: 1.5322 - accuracy: 0.4316 - val_loss: 1.5919 - val_accuracy: 0.4177 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 8/15
391/391 [==============================] - 5s 12ms/step - loss: 1.4851 - accuracy: 0.4537 - val_loss: 1.5573 - val_accuracy: 0.4404 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 9/15
391/391 [==============================] - 5s 12ms/step - loss: 1.4239 - accuracy: 0.4830 - val_loss: 1.5864 - val_accuracy: 0.4427 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 10/15
391/391 [==============================] - 5s 12ms/step - loss: 1.3639 - accuracy: 0.5110 - val_loss: 1.5345 - val_accuracy: 0.4553 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 11/15
391/391 [==============================] - 5s 12ms/step - loss: 1.3041 - accuracy: 0.5375 - val_loss: 1.6104 - val_accuracy: 0.4580 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 12/15
391/391 [==============================] - 5s 12ms/step - loss: 1.2468 - accuracy: 0.5629 - val_loss: 1.5217 - val_accuracy: 0.4793 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 13/15
391/391 [==============================] - 5s 12ms/step - loss: 1.1772 - accuracy: 0.5844 - val_loss: 1.5028 - val_accuracy: 0.4911 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 14/15
391/391 [==============================] - 5s 12ms/step - loss: 1.1116 - accuracy: 0.6118 - val_loss: 1.5030 - val_accuracy: 0.5063 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 15/15
391/391 [==============================] - 5s 12ms/step - loss: 1.0555 - accuracy: 0.6398 - val_loss: 1.4925 - val_accuracy: 0.5215 - lr: 1.0000e-04
isolating attack on cid: 1 in fed-epoch: 0
Target model test accuracy 0.544
Epoch 0 over :Attack test accuracy: 0.5005137324333191, Best accuracy : 0.5005137324333191
Epoch 1 over :Attack test accuracy: 0.5018267035484314, Best accuracy : 0.5018267035484314
Epoch 2 over :Attack test accuracy: 0.5528028607368469, Best accuracy : 0.5528028607368469
Epoch 3 over :Attack test accuracy: 0.5847699642181396, Best accuracy : 0.5847699642181396
Epoch 4 over :Attack test accuracy: 0.5778627991676331, Best accuracy : 0.5847699642181396
Epoch 5 over :Attack test accuracy: 0.5723826885223389, Best accuracy : 0.5847699642181396
Epoch 6 over :Attack test accuracy: 0.5827720165252686, Best accuracy : 0.5847699642181396
Epoch 7 over :Attack test accuracy: 0.5839136838912964, Best accuracy : 0.5847699642181396
Epoch 8 over :Attack test accuracy: 0.5847128629684448, Best accuracy : 0.5847699642181396
Epoch 9 over :Attack test accuracy: 0.5855120420455933, Best accuracy : 0.5855120420455933
/home/dc2-user/anaconda3/envs/memberinf_fed/lib/python3.7/site-packages/numpy/core/fromnumeric.py:3335: RuntimeWarning: Mean of empty slice.
  out=out, **kwargs)
/home/dc2-user/anaconda3/envs/memberinf_fed/lib/python3.7/site-packages/numpy/core/_methods.py:161: RuntimeWarning: invalid value encountered in double_scalars
  ret = ret.dtype.type(ret / rcount)
[fed-epoch 0] cid: 2
Using learning rate 0.0001
Epoch 1/15
391/391 [==============================] - 5s 12ms/step - loss: 2.0621 - accuracy: 0.1867 - val_loss: 1.9250 - val_accuracy: 0.2474 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 2/15
391/391 [==============================] - 5s 12ms/step - loss: 1.8537 - accuracy: 0.2769 - val_loss: 1.7902 - val_accuracy: 0.3100 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 3/15
391/391 [==============================] - 5s 12ms/step - loss: 1.7532 - accuracy: 0.3237 - val_loss: 1.7333 - val_accuracy: 0.3354 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 4/15
391/391 [==============================] - 5s 12ms/step - loss: 1.6836 - accuracy: 0.3520 - val_loss: 1.6856 - val_accuracy: 0.3613 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 5/15
391/391 [==============================] - 5s 12ms/step - loss: 1.6230 - accuracy: 0.3894 - val_loss: 1.5967 - val_accuracy: 0.4153 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 6/15
391/391 [==============================] - 5s 12ms/step - loss: 1.5636 - accuracy: 0.4234 - val_loss: 1.6169 - val_accuracy: 0.4158 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 7/15
391/391 [==============================] - 5s 12ms/step - loss: 1.4966 - accuracy: 0.4501 - val_loss: 1.5303 - val_accuracy: 0.4445 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 8/15
391/391 [==============================] - 5s 12ms/step - loss: 1.4357 - accuracy: 0.4802 - val_loss: 1.5252 - val_accuracy: 0.4588 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 9/15
391/391 [==============================] - 5s 12ms/step - loss: 1.3911 - accuracy: 0.5005 - val_loss: 1.5537 - val_accuracy: 0.4517 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 10/15
391/391 [==============================] - 5s 12ms/step - loss: 1.3155 - accuracy: 0.5350 - val_loss: 1.4697 - val_accuracy: 0.4827 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 11/15
391/391 [==============================] - 5s 12ms/step - loss: 1.2608 - accuracy: 0.5539 - val_loss: 1.4740 - val_accuracy: 0.4911 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 12/15
391/391 [==============================] - 5s 12ms/step - loss: 1.1889 - accuracy: 0.5831 - val_loss: 1.4265 - val_accuracy: 0.5130 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 13/15
391/391 [==============================] - 5s 12ms/step - loss: 1.1383 - accuracy: 0.6030 - val_loss: 1.4756 - val_accuracy: 0.5101 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 14/15
391/391 [==============================] - 5s 12ms/step - loss: 1.0740 - accuracy: 0.6268 - val_loss: 1.4987 - val_accuracy: 0.5093 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 15/15
391/391 [==============================] - 5s 12ms/step - loss: 1.0322 - accuracy: 0.6517 - val_loss: 1.4625 - val_accuracy: 0.5219 - lr: 1.0000e-04
[fed-epoch 0] cid: 3
Using learning rate 0.0001
Epoch 1/15
391/391 [==============================] - 5s 12ms/step - loss: 2.0525 - accuracy: 0.1890 - val_loss: 1.8898 - val_accuracy: 0.2562 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 2/15
391/391 [==============================] - 5s 12ms/step - loss: 1.8378 - accuracy: 0.2870 - val_loss: 1.7601 - val_accuracy: 0.3193 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 3/15
391/391 [==============================] - 5s 12ms/step - loss: 1.7360 - accuracy: 0.3365 - val_loss: 1.7049 - val_accuracy: 0.3531 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 4/15
391/391 [==============================] - 5s 12ms/step - loss: 1.6401 - accuracy: 0.3906 - val_loss: 1.6235 - val_accuracy: 0.4054 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 5/15
391/391 [==============================] - 5s 12ms/step - loss: 1.5677 - accuracy: 0.4235 - val_loss: 1.5650 - val_accuracy: 0.4313 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 6/15
391/391 [==============================] - 5s 12ms/step - loss: 1.4973 - accuracy: 0.4642 - val_loss: 1.5650 - val_accuracy: 0.4243 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 7/15
391/391 [==============================] - 5s 12ms/step - loss: 1.4404 - accuracy: 0.4823 - val_loss: 1.5101 - val_accuracy: 0.4674 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 8/15
391/391 [==============================] - 5s 12ms/step - loss: 1.3751 - accuracy: 0.5129 - val_loss: 1.4908 - val_accuracy: 0.4758 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 9/15
391/391 [==============================] - 5s 12ms/step - loss: 1.2999 - accuracy: 0.5486 - val_loss: 1.4716 - val_accuracy: 0.4893 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 10/15
391/391 [==============================] - 5s 12ms/step - loss: 1.2352 - accuracy: 0.5710 - val_loss: 1.4481 - val_accuracy: 0.5068 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 11/15
391/391 [==============================] - 5s 12ms/step - loss: 1.1632 - accuracy: 0.6033 - val_loss: 1.4233 - val_accuracy: 0.5233 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 12/15
391/391 [==============================] - 5s 12ms/step - loss: 1.1019 - accuracy: 0.6251 - val_loss: 1.4504 - val_accuracy: 0.5246 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 13/15
391/391 [==============================] - 5s 12ms/step - loss: 1.0371 - accuracy: 0.6523 - val_loss: 1.4666 - val_accuracy: 0.5248 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 14/15
391/391 [==============================] - 5s 12ms/step - loss: 0.9743 - accuracy: 0.6766 - val_loss: 1.5447 - val_accuracy: 0.5245 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 15/15
391/391 [==============================] - 5s 12ms/step - loss: 0.9187 - accuracy: 0.7017 - val_loss: 1.5871 - val_accuracy: 0.5223 - lr: 1.0000e-04
[fed-epoch 1] cid: 0
Using learning rate 0.0001
Epoch 1/15
391/391 [==============================] - 5s 12ms/step - loss: 1.9289 - accuracy: 0.2491 - val_loss: 1.7546 - val_accuracy: 0.3108 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 2/15
391/391 [==============================] - 5s 12ms/step - loss: 1.7331 - accuracy: 0.3349 - val_loss: 1.6583 - val_accuracy: 0.3767 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 3/15
391/391 [==============================] - 5s 12ms/step - loss: 1.6009 - accuracy: 0.4009 - val_loss: 1.5817 - val_accuracy: 0.4153 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 4/15
391/391 [==============================] - 5s 12ms/step - loss: 1.5048 - accuracy: 0.4426 - val_loss: 1.5138 - val_accuracy: 0.4497 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 5/15
391/391 [==============================] - 5s 12ms/step - loss: 1.4255 - accuracy: 0.4822 - val_loss: 1.4746 - val_accuracy: 0.4701 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 6/15
391/391 [==============================] - 5s 12ms/step - loss: 1.3498 - accuracy: 0.5136 - val_loss: 1.4786 - val_accuracy: 0.4765 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 7/15
391/391 [==============================] - 5s 12ms/step - loss: 1.2780 - accuracy: 0.5397 - val_loss: 1.4428 - val_accuracy: 0.4988 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 8/15
391/391 [==============================] - 5s 12ms/step - loss: 1.1957 - accuracy: 0.5748 - val_loss: 1.4066 - val_accuracy: 0.5128 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 9/15
391/391 [==============================] - 5s 12ms/step - loss: 1.1232 - accuracy: 0.6058 - val_loss: 1.4651 - val_accuracy: 0.4961 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 10/15
391/391 [==============================] - 5s 12ms/step - loss: 1.0570 - accuracy: 0.6283 - val_loss: 1.4053 - val_accuracy: 0.5255 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 11/15
391/391 [==============================] - 5s 12ms/step - loss: 0.9644 - accuracy: 0.6704 - val_loss: 1.5059 - val_accuracy: 0.5144 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 12/15
391/391 [==============================] - 5s 12ms/step - loss: 0.8898 - accuracy: 0.7019 - val_loss: 1.5952 - val_accuracy: 0.5217 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 13/15
391/391 [==============================] - 5s 12ms/step - loss: 0.8223 - accuracy: 0.7305 - val_loss: 1.5424 - val_accuracy: 0.5268 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 14/15
391/391 [==============================] - 5s 12ms/step - loss: 0.7367 - accuracy: 0.7627 - val_loss: 1.7077 - val_accuracy: 0.5165 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 15/15
391/391 [==============================] - 5s 12ms/step - loss: 0.6650 - accuracy: 0.7869 - val_loss: 1.7201 - val_accuracy: 0.5359 - lr: 1.0000e-04
[fed-epoch 1] cid: 1
Using learning rate 0.0001
Epoch 1/15
391/391 [==============================] - 5s 12ms/step - loss: 1.0092 - accuracy: 0.6570 - val_loss: 1.5212 - val_accuracy: 0.5221 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 2/15
391/391 [==============================] - 5s 12ms/step - loss: 0.9121 - accuracy: 0.6927 - val_loss: 1.5791 - val_accuracy: 0.5178 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 3/15
391/391 [==============================] - 5s 12ms/step - loss: 0.8647 - accuracy: 0.7131 - val_loss: 1.6312 - val_accuracy: 0.5145 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 4/15
391/391 [==============================] - 5s 12ms/step - loss: 0.8092 - accuracy: 0.7334 - val_loss: 1.6365 - val_accuracy: 0.5235 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 5/15
391/391 [==============================] - 5s 12ms/step - loss: 0.7567 - accuracy: 0.7595 - val_loss: 1.7050 - val_accuracy: 0.5230 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 6/15
391/391 [==============================] - 5s 12ms/step - loss: 0.7191 - accuracy: 0.7739 - val_loss: 1.8444 - val_accuracy: 0.5101 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 7/15
391/391 [==============================] - 5s 12ms/step - loss: 0.6834 - accuracy: 0.7897 - val_loss: 1.8653 - val_accuracy: 0.5147 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 8/15
391/391 [==============================] - 5s 12ms/step - loss: 0.6198 - accuracy: 0.8168 - val_loss: 1.9825 - val_accuracy: 0.5160 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 9/15
391/391 [==============================] - 5s 12ms/step - loss: 0.5976 - accuracy: 0.8239 - val_loss: 1.9894 - val_accuracy: 0.5233 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 10/15
391/391 [==============================] - 5s 12ms/step - loss: 0.5261 - accuracy: 0.8518 - val_loss: 2.2044 - val_accuracy: 0.5207 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 11/15
391/391 [==============================] - 5s 12ms/step - loss: 0.5160 - accuracy: 0.8594 - val_loss: 2.1573 - val_accuracy: 0.5204 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 12/15
391/391 [==============================] - 5s 12ms/step - loss: 0.4762 - accuracy: 0.8716 - val_loss: 2.3421 - val_accuracy: 0.5076 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 13/15
391/391 [==============================] - 5s 12ms/step - loss: 0.4622 - accuracy: 0.8774 - val_loss: 2.3862 - val_accuracy: 0.5164 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 14/15
391/391 [==============================] - 5s 12ms/step - loss: 0.4113 - accuracy: 0.8995 - val_loss: 2.5893 - val_accuracy: 0.5100 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 15/15
391/391 [==============================] - 5s 12ms/step - loss: 0.4481 - accuracy: 0.8837 - val_loss: 2.5087 - val_accuracy: 0.5040 - lr: 1.0000e-04
isolating attack on cid: 1 in fed-epoch: 1
Target model test accuracy 0.5216
Epoch 0 over :Attack test accuracy: 0.6141682863235474, Best accuracy : 0.6141682863235474
Epoch 1 over :Attack test accuracy: 0.7132092714309692, Best accuracy : 0.7132092714309692
Epoch 2 over :Attack test accuracy: 0.7161776423454285, Best accuracy : 0.7161776423454285
Epoch 3 over :Attack test accuracy: 0.7148076295852661, Best accuracy : 0.7161776423454285
Epoch 4 over :Attack test accuracy: 0.7141225934028625, Best accuracy : 0.7161776423454285
Epoch 5 over :Attack test accuracy: 0.7154355645179749, Best accuracy : 0.7161776423454285
Epoch 6 over :Attack test accuracy: 0.7145792841911316, Best accuracy : 0.7161776423454285
Epoch 7 over :Attack test accuracy: 0.7136659622192383, Best accuracy : 0.7161776423454285
Epoch 8 over :Attack test accuracy: 0.7116109132766724, Best accuracy : 0.7161776423454285
Epoch 9 over :Attack test accuracy: 0.702591598033905, Best accuracy : 0.7161776423454285
/home/dc2-user/anaconda3/envs/memberinf_fed/lib/python3.7/site-packages/numpy/core/fromnumeric.py:3335: RuntimeWarning: Mean of empty slice.
  out=out, **kwargs)
/home/dc2-user/anaconda3/envs/memberinf_fed/lib/python3.7/site-packages/numpy/core/_methods.py:161: RuntimeWarning: invalid value encountered in double_scalars
  ret = ret.dtype.type(ret / rcount)
[fed-epoch 1] cid: 2
Using learning rate 0.0001
Epoch 1/15
391/391 [==============================] - 5s 12ms/step - loss: 2.0075 - accuracy: 0.2034 - val_loss: 1.8468 - val_accuracy: 0.2661 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 2/15
391/391 [==============================] - 5s 12ms/step - loss: 1.7596 - accuracy: 0.3149 - val_loss: 1.6671 - val_accuracy: 0.3843 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 3/15
391/391 [==============================] - 5s 12ms/step - loss: 1.6339 - accuracy: 0.3829 - val_loss: 1.5802 - val_accuracy: 0.4232 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 4/15
391/391 [==============================] - 5s 12ms/step - loss: 1.5211 - accuracy: 0.4314 - val_loss: 1.5241 - val_accuracy: 0.4396 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 5/15
391/391 [==============================] - 5s 12ms/step - loss: 1.4433 - accuracy: 0.4691 - val_loss: 1.4656 - val_accuracy: 0.4704 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 6/15
391/391 [==============================] - 5s 12ms/step - loss: 1.3645 - accuracy: 0.5015 - val_loss: 1.4550 - val_accuracy: 0.4779 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 7/15
391/391 [==============================] - 5s 12ms/step - loss: 1.3075 - accuracy: 0.5256 - val_loss: 1.4475 - val_accuracy: 0.4941 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 8/15
391/391 [==============================] - 5s 12ms/step - loss: 1.2233 - accuracy: 0.5609 - val_loss: 1.4804 - val_accuracy: 0.4813 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 9/15
391/391 [==============================] - 5s 12ms/step - loss: 1.1552 - accuracy: 0.5921 - val_loss: 1.4390 - val_accuracy: 0.5140 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 10/15
391/391 [==============================] - 5s 12ms/step - loss: 1.0751 - accuracy: 0.6320 - val_loss: 1.5254 - val_accuracy: 0.4858 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 11/15
391/391 [==============================] - 5s 12ms/step - loss: 1.0135 - accuracy: 0.6515 - val_loss: 1.4427 - val_accuracy: 0.5274 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 12/15
391/391 [==============================] - 5s 12ms/step - loss: 0.9368 - accuracy: 0.6786 - val_loss: 1.5280 - val_accuracy: 0.5131 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 13/15
391/391 [==============================] - 5s 12ms/step - loss: 0.8600 - accuracy: 0.7125 - val_loss: 1.5363 - val_accuracy: 0.5328 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 14/15
391/391 [==============================] - 4s 11ms/step - loss: 0.7957 - accuracy: 0.7428 - val_loss: 1.6577 - val_accuracy: 0.5256 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 15/15
391/391 [==============================] - 5s 12ms/step - loss: 0.7129 - accuracy: 0.7728 - val_loss: 1.7209 - val_accuracy: 0.5309 - lr: 1.0000e-04
[fed-epoch 1] cid: 3
Using learning rate 0.0001
Epoch 1/15
391/391 [==============================] - 5s 12ms/step - loss: 2.1721 - accuracy: 0.1684 - val_loss: 1.9198 - val_accuracy: 0.2573 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 2/15
391/391 [==============================] - 5s 12ms/step - loss: 1.8440 - accuracy: 0.2731 - val_loss: 1.8411 - val_accuracy: 0.2617 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 3/15
391/391 [==============================] - 5s 12ms/step - loss: 1.7516 - accuracy: 0.3170 - val_loss: 1.7176 - val_accuracy: 0.3598 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 4/15
391/391 [==============================] - 5s 12ms/step - loss: 1.6535 - accuracy: 0.3747 - val_loss: 1.5934 - val_accuracy: 0.4056 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 5/15
391/391 [==============================] - 5s 12ms/step - loss: 1.5518 - accuracy: 0.4264 - val_loss: 1.5531 - val_accuracy: 0.4260 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 6/15
391/391 [==============================] - 5s 12ms/step - loss: 1.4689 - accuracy: 0.4592 - val_loss: 1.5203 - val_accuracy: 0.4433 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 7/15
391/391 [==============================] - 5s 12ms/step - loss: 1.4013 - accuracy: 0.4921 - val_loss: 1.4764 - val_accuracy: 0.4640 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 8/15
391/391 [==============================] - 5s 12ms/step - loss: 1.3327 - accuracy: 0.5226 - val_loss: 1.4386 - val_accuracy: 0.4858 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 9/15
391/391 [==============================] - 5s 12ms/step - loss: 1.2619 - accuracy: 0.5486 - val_loss: 1.4716 - val_accuracy: 0.4807 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 10/15
391/391 [==============================] - 5s 12ms/step - loss: 1.2092 - accuracy: 0.5735 - val_loss: 1.4232 - val_accuracy: 0.5102 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 11/15
391/391 [==============================] - 5s 12ms/step - loss: 1.1550 - accuracy: 0.5868 - val_loss: 1.4203 - val_accuracy: 0.5095 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 12/15
391/391 [==============================] - 5s 12ms/step - loss: 1.0797 - accuracy: 0.6205 - val_loss: 1.4289 - val_accuracy: 0.5172 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 13/15
391/391 [==============================] - 5s 12ms/step - loss: 1.0161 - accuracy: 0.6427 - val_loss: 1.5656 - val_accuracy: 0.5052 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 14/15
391/391 [==============================] - 5s 12ms/step - loss: 0.9375 - accuracy: 0.6827 - val_loss: 1.4841 - val_accuracy: 0.5280 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 15/15
391/391 [==============================] - 5s 12ms/step - loss: 0.8680 - accuracy: 0.7042 - val_loss: 1.5721 - val_accuracy: 0.5162 - lr: 1.0000e-04
[fed-epoch 2] cid: 0
Using learning rate 0.0001
Epoch 1/15
391/391 [==============================] - 5s 12ms/step - loss: 1.4062 - accuracy: 0.5023 - val_loss: 1.3799 - val_accuracy: 0.5155 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 2/15
391/391 [==============================] - 5s 12ms/step - loss: 1.2307 - accuracy: 0.5681 - val_loss: 1.4201 - val_accuracy: 0.5072 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 3/15
391/391 [==============================] - 5s 12ms/step - loss: 1.1142 - accuracy: 0.6107 - val_loss: 1.4268 - val_accuracy: 0.5236 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 4/15
391/391 [==============================] - 5s 12ms/step - loss: 1.0188 - accuracy: 0.6557 - val_loss: 1.4703 - val_accuracy: 0.5251 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 5/15
391/391 [==============================] - 5s 12ms/step - loss: 0.9369 - accuracy: 0.6875 - val_loss: 1.4679 - val_accuracy: 0.5279 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 6/15
391/391 [==============================] - 5s 12ms/step - loss: 0.8306 - accuracy: 0.7268 - val_loss: 1.5065 - val_accuracy: 0.5422 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 7/15
391/391 [==============================] - 5s 12ms/step - loss: 0.7281 - accuracy: 0.7658 - val_loss: 1.5925 - val_accuracy: 0.5452 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 8/15
391/391 [==============================] - 5s 12ms/step - loss: 0.6703 - accuracy: 0.7910 - val_loss: 1.7029 - val_accuracy: 0.5372 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 9/15
391/391 [==============================] - 5s 12ms/step - loss: 0.5752 - accuracy: 0.8266 - val_loss: 1.7764 - val_accuracy: 0.5409 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 10/15
391/391 [==============================] - 5s 12ms/step - loss: 0.5075 - accuracy: 0.8572 - val_loss: 1.9331 - val_accuracy: 0.5480 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 11/15
391/391 [==============================] - 5s 12ms/step - loss: 0.4510 - accuracy: 0.8790 - val_loss: 2.1565 - val_accuracy: 0.5259 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 12/15
391/391 [==============================] - 5s 12ms/step - loss: 0.4071 - accuracy: 0.8957 - val_loss: 2.2127 - val_accuracy: 0.5251 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 13/15
391/391 [==============================] - 5s 12ms/step - loss: 0.3712 - accuracy: 0.9099 - val_loss: 2.2868 - val_accuracy: 0.5243 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 14/15
391/391 [==============================] - 5s 12ms/step - loss: 0.3489 - accuracy: 0.9211 - val_loss: 2.5221 - val_accuracy: 0.5225 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 15/15
391/391 [==============================] - 5s 12ms/step - loss: 0.2901 - accuracy: 0.9458 - val_loss: 2.6277 - val_accuracy: 0.5304 - lr: 1.0000e-04
[fed-epoch 2] cid: 1
Using learning rate 0.0001
Epoch 1/15
391/391 [==============================] - 5s 12ms/step - loss: 0.4913 - accuracy: 0.8691 - val_loss: 2.2953 - val_accuracy: 0.5148 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 2/15
391/391 [==============================] - 5s 12ms/step - loss: 0.3870 - accuracy: 0.9085 - val_loss: 2.5570 - val_accuracy: 0.5123 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 3/15
391/391 [==============================] - 5s 12ms/step - loss: 0.3496 - accuracy: 0.9238 - val_loss: 2.8424 - val_accuracy: 0.5175 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 4/15
391/391 [==============================] - 5s 12ms/step - loss: 0.3395 - accuracy: 0.9278 - val_loss: 2.6800 - val_accuracy: 0.5106 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 5/15
391/391 [==============================] - 5s 12ms/step - loss: 0.3120 - accuracy: 0.9386 - val_loss: 2.8806 - val_accuracy: 0.5171 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 6/15
391/391 [==============================] - 5s 12ms/step - loss: 0.2981 - accuracy: 0.9419 - val_loss: 2.9433 - val_accuracy: 0.5125 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 7/15
391/391 [==============================] - 5s 12ms/step - loss: 0.3053 - accuracy: 0.9377 - val_loss: 3.0083 - val_accuracy: 0.5100 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 8/15
391/391 [==============================] - 5s 12ms/step - loss: 0.2990 - accuracy: 0.9450 - val_loss: 3.0511 - val_accuracy: 0.5141 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 9/15
391/391 [==============================] - 5s 12ms/step - loss: 0.2916 - accuracy: 0.9447 - val_loss: 2.8764 - val_accuracy: 0.5140 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 10/15
391/391 [==============================] - 5s 12ms/step - loss: 0.2601 - accuracy: 0.9573 - val_loss: 3.1387 - val_accuracy: 0.5212 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 11/15
391/391 [==============================] - 5s 12ms/step - loss: 0.2948 - accuracy: 0.9453 - val_loss: 3.0520 - val_accuracy: 0.5176 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 12/15
391/391 [==============================] - 5s 12ms/step - loss: 0.2511 - accuracy: 0.9596 - val_loss: 3.3862 - val_accuracy: 0.4978 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 13/15
391/391 [==============================] - 5s 12ms/step - loss: 0.2328 - accuracy: 0.9674 - val_loss: 3.2705 - val_accuracy: 0.5178 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 14/15
391/391 [==============================] - 5s 12ms/step - loss: 0.2350 - accuracy: 0.9649 - val_loss: 3.3104 - val_accuracy: 0.5155 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 15/15
391/391 [==============================] - 5s 12ms/step - loss: 0.2481 - accuracy: 0.9608 - val_loss: 3.2246 - val_accuracy: 0.5220 - lr: 1.0000e-04
isolating attack on cid: 1 in fed-epoch: 2
Target model test accuracy 0.5304
Epoch 0 over :Attack test accuracy: 0.7407238483428955, Best accuracy : 0.7407238483428955
Epoch 1 over :Attack test accuracy: 0.7490581274032593, Best accuracy : 0.7490581274032593
Epoch 2 over :Attack test accuracy: 0.7581915855407715, Best accuracy : 0.7581915855407715
Epoch 3 over :Attack test accuracy: 0.7571069598197937, Best accuracy : 0.7581915855407715
Epoch 4 over :Attack test accuracy: 0.755394458770752, Best accuracy : 0.7581915855407715
Epoch 5 over :Attack test accuracy: 0.7541385889053345, Best accuracy : 0.7581915855407715
Epoch 6 over :Attack test accuracy: 0.7536248564720154, Best accuracy : 0.7581915855407715
Epoch 7 over :Attack test accuracy: 0.7526544332504272, Best accuracy : 0.7581915855407715
Epoch 8 over :Attack test accuracy: 0.7513414621353149, Best accuracy : 0.7581915855407715
Epoch 9 over :Attack test accuracy: 0.7505422830581665, Best accuracy : 0.7581915855407715
/home/dc2-user/anaconda3/envs/memberinf_fed/lib/python3.7/site-packages/numpy/core/fromnumeric.py:3335: RuntimeWarning: Mean of empty slice.
  out=out, **kwargs)
/home/dc2-user/anaconda3/envs/memberinf_fed/lib/python3.7/site-packages/numpy/core/_methods.py:161: RuntimeWarning: invalid value encountered in double_scalars
  ret = ret.dtype.type(ret / rcount)
[fed-epoch 2] cid: 2
Using learning rate 0.0001
Epoch 1/15
391/391 [==============================] - 5s 12ms/step - loss: 1.4428 - accuracy: 0.4922 - val_loss: 1.3533 - val_accuracy: 0.5221 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 2/15
391/391 [==============================] - 5s 12ms/step - loss: 1.2654 - accuracy: 0.5557 - val_loss: 1.3860 - val_accuracy: 0.5238 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 3/15
391/391 [==============================] - 5s 12ms/step - loss: 1.1560 - accuracy: 0.5991 - val_loss: 1.3713 - val_accuracy: 0.5321 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 4/15
391/391 [==============================] - 5s 12ms/step - loss: 1.0632 - accuracy: 0.6388 - val_loss: 1.3581 - val_accuracy: 0.5520 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 5/15
391/391 [==============================] - 5s 12ms/step - loss: 0.9617 - accuracy: 0.6803 - val_loss: 1.4507 - val_accuracy: 0.5373 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 6/15
391/391 [==============================] - 5s 12ms/step - loss: 0.8783 - accuracy: 0.7115 - val_loss: 1.3940 - val_accuracy: 0.5645 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 7/15
391/391 [==============================] - 5s 12ms/step - loss: 0.7664 - accuracy: 0.7556 - val_loss: 1.4999 - val_accuracy: 0.5518 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 8/15
391/391 [==============================] - 5s 12ms/step - loss: 0.6860 - accuracy: 0.7873 - val_loss: 1.6975 - val_accuracy: 0.5272 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 9/15
391/391 [==============================] - 5s 12ms/step - loss: 0.5941 - accuracy: 0.8230 - val_loss: 1.7282 - val_accuracy: 0.5463 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 10/15
391/391 [==============================] - 5s 12ms/step - loss: 0.5359 - accuracy: 0.8455 - val_loss: 1.8620 - val_accuracy: 0.5341 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 11/15
391/391 [==============================] - 5s 12ms/step - loss: 0.4794 - accuracy: 0.8694 - val_loss: 1.9899 - val_accuracy: 0.5380 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 12/15
391/391 [==============================] - 5s 12ms/step - loss: 0.4319 - accuracy: 0.8850 - val_loss: 1.9894 - val_accuracy: 0.5460 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 13/15
391/391 [==============================] - 4s 11ms/step - loss: 0.3718 - accuracy: 0.9112 - val_loss: 2.1804 - val_accuracy: 0.5399 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 14/15
391/391 [==============================] - 4s 11ms/step - loss: 0.3786 - accuracy: 0.9101 - val_loss: 2.3242 - val_accuracy: 0.5115 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 15/15
391/391 [==============================] - 4s 11ms/step - loss: 0.3154 - accuracy: 0.9347 - val_loss: 2.3397 - val_accuracy: 0.5442 - lr: 1.0000e-04
[fed-epoch 2] cid: 3
Using learning rate 0.0001
Epoch 1/15
391/391 [==============================] - 5s 12ms/step - loss: 1.3984 - accuracy: 0.5140 - val_loss: 1.4068 - val_accuracy: 0.5038 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 2/15
391/391 [==============================] - 5s 12ms/step - loss: 1.2381 - accuracy: 0.5676 - val_loss: 1.3628 - val_accuracy: 0.5344 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 3/15
391/391 [==============================] - 5s 12ms/step - loss: 1.1417 - accuracy: 0.6103 - val_loss: 1.3513 - val_accuracy: 0.5455 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 4/15
391/391 [==============================] - 5s 12ms/step - loss: 1.0500 - accuracy: 0.6378 - val_loss: 1.3771 - val_accuracy: 0.5409 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 5/15
391/391 [==============================] - 5s 12ms/step - loss: 0.9739 - accuracy: 0.6677 - val_loss: 1.4507 - val_accuracy: 0.5380 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 6/15
391/391 [==============================] - 5s 12ms/step - loss: 0.8649 - accuracy: 0.7116 - val_loss: 1.4569 - val_accuracy: 0.5421 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 7/15
391/391 [==============================] - 5s 12ms/step - loss: 0.7764 - accuracy: 0.7463 - val_loss: 1.5257 - val_accuracy: 0.5480 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 8/15
391/391 [==============================] - 5s 12ms/step - loss: 0.7005 - accuracy: 0.7762 - val_loss: 1.5882 - val_accuracy: 0.5471 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 9/15
391/391 [==============================] - 4s 11ms/step - loss: 0.6352 - accuracy: 0.8000 - val_loss: 1.7902 - val_accuracy: 0.5282 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 10/15
391/391 [==============================] - 4s 10ms/step - loss: 0.5714 - accuracy: 0.8280 - val_loss: 1.7948 - val_accuracy: 0.5418 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 11/15
391/391 [==============================] - 4s 11ms/step - loss: 0.5053 - accuracy: 0.8545 - val_loss: 1.8926 - val_accuracy: 0.5516 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 12/15
391/391 [==============================] - 5s 12ms/step - loss: 0.4543 - accuracy: 0.8788 - val_loss: 2.0869 - val_accuracy: 0.5322 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 13/15
391/391 [==============================] - 5s 12ms/step - loss: 0.4314 - accuracy: 0.8829 - val_loss: 2.0253 - val_accuracy: 0.5559 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 14/15
391/391 [==============================] - 5s 12ms/step - loss: 0.3588 - accuracy: 0.9163 - val_loss: 2.2945 - val_accuracy: 0.5355 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 15/15
391/391 [==============================] - 5s 12ms/step - loss: 0.3333 - accuracy: 0.9229 - val_loss: 2.3146 - val_accuracy: 0.5420 - lr: 1.0000e-04
[fed-epoch 3] cid: 0
Using learning rate 0.0001
Epoch 1/15
391/391 [==============================] - 5s 12ms/step - loss: 1.1702 - accuracy: 0.6026 - val_loss: 1.4016 - val_accuracy: 0.5365 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 2/15
391/391 [==============================] - 4s 11ms/step - loss: 0.9672 - accuracy: 0.6802 - val_loss: 1.3554 - val_accuracy: 0.5561 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 3/15
391/391 [==============================] - 5s 12ms/step - loss: 0.8185 - accuracy: 0.7361 - val_loss: 1.4856 - val_accuracy: 0.5421 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 4/15
391/391 [==============================] - 5s 12ms/step - loss: 0.6855 - accuracy: 0.7866 - val_loss: 1.6469 - val_accuracy: 0.5525 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 5/15
391/391 [==============================] - 5s 12ms/step - loss: 0.5875 - accuracy: 0.8284 - val_loss: 1.6497 - val_accuracy: 0.5467 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 6/15
391/391 [==============================] - 5s 12ms/step - loss: 0.5153 - accuracy: 0.8506 - val_loss: 2.0651 - val_accuracy: 0.5320 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 7/15
391/391 [==============================] - 5s 12ms/step - loss: 0.4366 - accuracy: 0.8837 - val_loss: 2.0229 - val_accuracy: 0.5528 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 8/15
391/391 [==============================] - 5s 12ms/step - loss: 0.3816 - accuracy: 0.9070 - val_loss: 2.1092 - val_accuracy: 0.5501 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 9/15
391/391 [==============================] - 5s 12ms/step - loss: 0.3573 - accuracy: 0.9176 - val_loss: 2.2080 - val_accuracy: 0.5449 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 10/15
391/391 [==============================] - 5s 12ms/step - loss: 0.3218 - accuracy: 0.9292 - val_loss: 2.3223 - val_accuracy: 0.5474 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 11/15
391/391 [==============================] - 5s 12ms/step - loss: 0.2922 - accuracy: 0.9430 - val_loss: 2.3983 - val_accuracy: 0.5514 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 12/15
391/391 [==============================] - 5s 12ms/step - loss: 0.2724 - accuracy: 0.9496 - val_loss: 2.4988 - val_accuracy: 0.5404 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 13/15
391/391 [==============================] - 5s 12ms/step - loss: 0.2755 - accuracy: 0.9470 - val_loss: 2.4564 - val_accuracy: 0.5490 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 14/15
391/391 [==============================] - 5s 12ms/step - loss: 0.2630 - accuracy: 0.9533 - val_loss: 2.4327 - val_accuracy: 0.5516 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 15/15
391/391 [==============================] - 5s 12ms/step - loss: 0.2351 - accuracy: 0.9657 - val_loss: 2.5623 - val_accuracy: 0.5527 - lr: 1.0000e-04
[fed-epoch 3] cid: 1
Using learning rate 0.0001
Epoch 1/15
391/391 [==============================] - 5s 12ms/step - loss: 0.3137 - accuracy: 0.9376 - val_loss: 3.0466 - val_accuracy: 0.5204 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 2/15
391/391 [==============================] - 5s 12ms/step - loss: 0.2246 - accuracy: 0.9703 - val_loss: 3.1220 - val_accuracy: 0.5185 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 3/15
391/391 [==============================] - 5s 12ms/step - loss: 0.2146 - accuracy: 0.9733 - val_loss: 3.2161 - val_accuracy: 0.5130 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 4/15
391/391 [==============================] - 5s 12ms/step - loss: 0.2483 - accuracy: 0.9610 - val_loss: 3.2152 - val_accuracy: 0.5175 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 5/15
391/391 [==============================] - 5s 12ms/step - loss: 0.2136 - accuracy: 0.9735 - val_loss: 3.2780 - val_accuracy: 0.5194 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 6/15
391/391 [==============================] - 5s 12ms/step - loss: 0.2075 - accuracy: 0.9746 - val_loss: 3.3797 - val_accuracy: 0.5098 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 7/15
391/391 [==============================] - 5s 12ms/step - loss: 0.2121 - accuracy: 0.9737 - val_loss: 3.3390 - val_accuracy: 0.5249 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 8/15
391/391 [==============================] - 5s 12ms/step - loss: 0.2521 - accuracy: 0.9572 - val_loss: 3.1740 - val_accuracy: 0.5208 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 9/15
391/391 [==============================] - 5s 12ms/step - loss: 0.1897 - accuracy: 0.9820 - val_loss: 3.4173 - val_accuracy: 0.5137 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 10/15
391/391 [==============================] - 5s 12ms/step - loss: 0.2025 - accuracy: 0.9775 - val_loss: 3.4578 - val_accuracy: 0.5212 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 11/15
391/391 [==============================] - 5s 12ms/step - loss: 0.2046 - accuracy: 0.9742 - val_loss: 3.2307 - val_accuracy: 0.5232 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 12/15
391/391 [==============================] - 5s 12ms/step - loss: 0.2304 - accuracy: 0.9636 - val_loss: 3.3345 - val_accuracy: 0.5101 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 13/15
391/391 [==============================] - 5s 12ms/step - loss: 0.2110 - accuracy: 0.9740 - val_loss: 3.3587 - val_accuracy: 0.5139 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 14/15
391/391 [==============================] - 5s 12ms/step - loss: 0.2129 - accuracy: 0.9727 - val_loss: 3.6338 - val_accuracy: 0.5081 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 15/15
391/391 [==============================] - 5s 12ms/step - loss: 0.1896 - accuracy: 0.9802 - val_loss: 3.3509 - val_accuracy: 0.5132 - lr: 1.0000e-04
isolating attack on cid: 1 in fed-epoch: 3
Target model test accuracy 0.5416
Epoch 0 over :Attack test accuracy: 0.7466034889221191, Best accuracy : 0.7466034889221191
Epoch 1 over :Attack test accuracy: 0.7436922192573547, Best accuracy : 0.7466034889221191
Epoch 2 over :Attack test accuracy: 0.7662975192070007, Best accuracy : 0.7662975192070007
Epoch 3 over :Attack test accuracy: 0.7701221704483032, Best accuracy : 0.7701221704483032
Epoch 4 over :Attack test accuracy: 0.7713209390640259, Best accuracy : 0.7713209390640259
Epoch 5 over :Attack test accuracy: 0.7676675319671631, Best accuracy : 0.7713209390640259
Epoch 6 over :Attack test accuracy: 0.7696083784103394, Best accuracy : 0.7713209390640259
Epoch 7 over :Attack test accuracy: 0.7700650691986084, Best accuracy : 0.7713209390640259
Epoch 8 over :Attack test accuracy: 0.7622445225715637, Best accuracy : 0.7713209390640259
Epoch 9 over :Attack test accuracy: 0.7690946459770203, Best accuracy : 0.7713209390640259
/home/dc2-user/anaconda3/envs/memberinf_fed/lib/python3.7/site-packages/numpy/core/fromnumeric.py:3335: RuntimeWarning: Mean of empty slice.
  out=out, **kwargs)
/home/dc2-user/anaconda3/envs/memberinf_fed/lib/python3.7/site-packages/numpy/core/_methods.py:161: RuntimeWarning: invalid value encountered in double_scalars
  ret = ret.dtype.type(ret / rcount)
[fed-epoch 3] cid: 2
Using learning rate 0.0001
Epoch 1/15
391/391 [==============================] - 5s 12ms/step - loss: 1.2491 - accuracy: 0.5782 - val_loss: 1.3738 - val_accuracy: 0.5481 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 2/15
391/391 [==============================] - 5s 12ms/step - loss: 1.0174 - accuracy: 0.6664 - val_loss: 1.3731 - val_accuracy: 0.5598 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 3/15
391/391 [==============================] - 5s 12ms/step - loss: 0.8566 - accuracy: 0.7210 - val_loss: 1.4373 - val_accuracy: 0.5564 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 4/15
391/391 [==============================] - 5s 13ms/step - loss: 0.7129 - accuracy: 0.7788 - val_loss: 1.6149 - val_accuracy: 0.5336 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 5/15
391/391 [==============================] - 5s 12ms/step - loss: 0.6021 - accuracy: 0.8194 - val_loss: 1.7035 - val_accuracy: 0.5535 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 6/15
391/391 [==============================] - 5s 12ms/step - loss: 0.4965 - accuracy: 0.8626 - val_loss: 1.8594 - val_accuracy: 0.5547 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 7/15
391/391 [==============================] - 5s 12ms/step - loss: 0.4496 - accuracy: 0.8750 - val_loss: 1.8817 - val_accuracy: 0.5602 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 8/15
391/391 [==============================] - 5s 12ms/step - loss: 0.3698 - accuracy: 0.9139 - val_loss: 2.1643 - val_accuracy: 0.5455 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 9/15
391/391 [==============================] - 5s 12ms/step - loss: 0.3227 - accuracy: 0.9299 - val_loss: 2.1589 - val_accuracy: 0.5597 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 10/15
391/391 [==============================] - 5s 12ms/step - loss: 0.2940 - accuracy: 0.9412 - val_loss: 2.3377 - val_accuracy: 0.5540 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 11/15
391/391 [==============================] - 5s 12ms/step - loss: 0.2862 - accuracy: 0.9446 - val_loss: 2.3895 - val_accuracy: 0.5523 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 12/15
391/391 [==============================] - 5s 12ms/step - loss: 0.2553 - accuracy: 0.9578 - val_loss: 2.4280 - val_accuracy: 0.5505 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 13/15
391/391 [==============================] - 5s 12ms/step - loss: 0.2691 - accuracy: 0.9525 - val_loss: 2.4631 - val_accuracy: 0.5511 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 14/15
391/391 [==============================] - 5s 12ms/step - loss: 0.2311 - accuracy: 0.9662 - val_loss: 2.7746 - val_accuracy: 0.5255 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 15/15
391/391 [==============================] - 5s 12ms/step - loss: 0.2181 - accuracy: 0.9716 - val_loss: 2.6911 - val_accuracy: 0.5499 - lr: 1.0000e-04
[fed-epoch 3] cid: 3
Using learning rate 0.0001
Epoch 1/15
391/391 [==============================] - 5s 12ms/step - loss: 1.1968 - accuracy: 0.5989 - val_loss: 1.4546 - val_accuracy: 0.5288 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 2/15
391/391 [==============================] - 5s 12ms/step - loss: 0.9850 - accuracy: 0.6804 - val_loss: 1.4218 - val_accuracy: 0.5372 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 3/15
391/391 [==============================] - 5s 12ms/step - loss: 0.8231 - accuracy: 0.7369 - val_loss: 1.4216 - val_accuracy: 0.5606 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 4/15
391/391 [==============================] - 5s 12ms/step - loss: 0.7062 - accuracy: 0.7855 - val_loss: 1.5861 - val_accuracy: 0.5540 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 5/15
391/391 [==============================] - 5s 12ms/step - loss: 0.6000 - accuracy: 0.8227 - val_loss: 1.6431 - val_accuracy: 0.5632 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 6/15
391/391 [==============================] - 5s 12ms/step - loss: 0.5162 - accuracy: 0.8575 - val_loss: 1.8598 - val_accuracy: 0.5357 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 7/15
391/391 [==============================] - 5s 12ms/step - loss: 0.4625 - accuracy: 0.8762 - val_loss: 1.8842 - val_accuracy: 0.5572 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 8/15
391/391 [==============================] - 5s 12ms/step - loss: 0.3767 - accuracy: 0.9138 - val_loss: 2.1792 - val_accuracy: 0.5334 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 9/15
391/391 [==============================] - 5s 12ms/step - loss: 0.3550 - accuracy: 0.9182 - val_loss: 2.1419 - val_accuracy: 0.5345 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 10/15
391/391 [==============================] - 5s 12ms/step - loss: 0.3283 - accuracy: 0.9270 - val_loss: 2.1383 - val_accuracy: 0.5460 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 11/15
391/391 [==============================] - 5s 12ms/step - loss: 0.2997 - accuracy: 0.9398 - val_loss: 2.2243 - val_accuracy: 0.5537 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 12/15
391/391 [==============================] - 5s 12ms/step - loss: 0.2816 - accuracy: 0.9478 - val_loss: 2.2432 - val_accuracy: 0.5546 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 13/15
391/391 [==============================] - 5s 12ms/step - loss: 0.2683 - accuracy: 0.9504 - val_loss: 2.4532 - val_accuracy: 0.5421 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 14/15
391/391 [==============================] - 5s 12ms/step - loss: 0.2312 - accuracy: 0.9664 - val_loss: 2.4726 - val_accuracy: 0.5619 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 15/15
391/391 [==============================] - 5s 12ms/step - loss: 0.2423 - accuracy: 0.9616 - val_loss: 2.5027 - val_accuracy: 0.5514 - lr: 1.0000e-04
[fed-epoch 4] cid: 0
Using learning rate 0.0001
Epoch 1/15
391/391 [==============================] - 5s 12ms/step - loss: 1.0927 - accuracy: 0.6504 - val_loss: 1.4055 - val_accuracy: 0.5583 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 2/15
391/391 [==============================] - 5s 12ms/step - loss: 0.8208 - accuracy: 0.7362 - val_loss: 1.5119 - val_accuracy: 0.5477 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 3/15
391/391 [==============================] - 5s 12ms/step - loss: 0.6670 - accuracy: 0.7951 - val_loss: 1.5989 - val_accuracy: 0.5664 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 4/15
391/391 [==============================] - 5s 12ms/step - loss: 0.5105 - accuracy: 0.8592 - val_loss: 1.8095 - val_accuracy: 0.5592 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 5/15
391/391 [==============================] - 5s 12ms/step - loss: 0.4299 - accuracy: 0.8859 - val_loss: 2.0432 - val_accuracy: 0.5448 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 6/15
391/391 [==============================] - 5s 12ms/step - loss: 0.3667 - accuracy: 0.9147 - val_loss: 2.0869 - val_accuracy: 0.5622 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 7/15
391/391 [==============================] - 5s 12ms/step - loss: 0.3295 - accuracy: 0.9287 - val_loss: 2.3764 - val_accuracy: 0.5430 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 8/15
391/391 [==============================] - 5s 12ms/step - loss: 0.2815 - accuracy: 0.9480 - val_loss: 2.3226 - val_accuracy: 0.5541 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 9/15
391/391 [==============================] - 5s 12ms/step - loss: 0.2953 - accuracy: 0.9406 - val_loss: 2.2539 - val_accuracy: 0.5586 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 10/15
391/391 [==============================] - 5s 12ms/step - loss: 0.2528 - accuracy: 0.9579 - val_loss: 2.4966 - val_accuracy: 0.5507 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 11/15
391/391 [==============================] - 5s 12ms/step - loss: 0.2517 - accuracy: 0.9585 - val_loss: 2.4241 - val_accuracy: 0.5596 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 12/15
391/391 [==============================] - 5s 12ms/step - loss: 0.2353 - accuracy: 0.9632 - val_loss: 2.5533 - val_accuracy: 0.5578 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 13/15
391/391 [==============================] - 5s 12ms/step - loss: 0.2307 - accuracy: 0.9655 - val_loss: 2.4493 - val_accuracy: 0.5524 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 14/15
391/391 [==============================] - 5s 12ms/step - loss: 0.2294 - accuracy: 0.9658 - val_loss: 2.4806 - val_accuracy: 0.5634 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 15/15
391/391 [==============================] - 5s 12ms/step - loss: 0.2256 - accuracy: 0.9667 - val_loss: 2.7686 - val_accuracy: 0.5346 - lr: 1.0000e-04
[fed-epoch 4] cid: 1
Using learning rate 0.0001
Epoch 1/15
391/391 [==============================] - 5s 12ms/step - loss: 0.2280 - accuracy: 0.9670 - val_loss: 3.3319 - val_accuracy: 0.5109 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 2/15
391/391 [==============================] - 5s 12ms/step - loss: 0.1941 - accuracy: 0.9794 - val_loss: 3.3546 - val_accuracy: 0.5212 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 3/15
391/391 [==============================] - 5s 12ms/step - loss: 0.1963 - accuracy: 0.9785 - val_loss: 3.2965 - val_accuracy: 0.5310 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 4/15
391/391 [==============================] - 5s 12ms/step - loss: 0.1655 - accuracy: 0.9882 - val_loss: 3.5910 - val_accuracy: 0.5232 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 5/15
391/391 [==============================] - 5s 12ms/step - loss: 0.1898 - accuracy: 0.9800 - val_loss: 3.3785 - val_accuracy: 0.5112 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 6/15
391/391 [==============================] - 5s 12ms/step - loss: 0.1905 - accuracy: 0.9794 - val_loss: 3.5265 - val_accuracy: 0.5141 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 7/15
391/391 [==============================] - 5s 12ms/step - loss: 0.2059 - accuracy: 0.9743 - val_loss: 3.4969 - val_accuracy: 0.5219 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 8/15
391/391 [==============================] - 5s 12ms/step - loss: 0.1779 - accuracy: 0.9835 - val_loss: 3.6737 - val_accuracy: 0.5182 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 9/15
391/391 [==============================] - 5s 12ms/step - loss: 0.1715 - accuracy: 0.9854 - val_loss: 3.4766 - val_accuracy: 0.5233 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 10/15
391/391 [==============================] - 5s 12ms/step - loss: 0.2202 - accuracy: 0.9687 - val_loss: 3.3470 - val_accuracy: 0.5139 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 11/15
391/391 [==============================] - 5s 12ms/step - loss: 0.1663 - accuracy: 0.9875 - val_loss: 3.5180 - val_accuracy: 0.5218 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 12/15
391/391 [==============================] - 5s 12ms/step - loss: 0.1728 - accuracy: 0.9845 - val_loss: 3.4562 - val_accuracy: 0.5299 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 13/15
391/391 [==============================] - 5s 12ms/step - loss: 0.1882 - accuracy: 0.9786 - val_loss: 3.5530 - val_accuracy: 0.5212 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 14/15
391/391 [==============================] - 5s 12ms/step - loss: 0.1903 - accuracy: 0.9782 - val_loss: 3.3338 - val_accuracy: 0.5297 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 15/15
391/391 [==============================] - 5s 12ms/step - loss: 0.2038 - accuracy: 0.9750 - val_loss: 3.2919 - val_accuracy: 0.5131 - lr: 1.0000e-04
isolating attack on cid: 1 in fed-epoch: 4
Target model test accuracy 0.5328
Epoch 0 over :Attack test accuracy: 0.7414088249206543, Best accuracy : 0.7414088249206543
Epoch 1 over :Attack test accuracy: 0.7608745098114014, Best accuracy : 0.7608745098114014
Epoch 2 over :Attack test accuracy: 0.7577919960021973, Best accuracy : 0.7608745098114014
Epoch 3 over :Attack test accuracy: 0.7483159899711609, Best accuracy : 0.7608745098114014
Epoch 4 over :Attack test accuracy: 0.7484872937202454, Best accuracy : 0.7608745098114014
Epoch 5 over :Attack test accuracy: 0.7474026679992676, Best accuracy : 0.7608745098114014
Epoch 6 over :Attack test accuracy: 0.7652699947357178, Best accuracy : 0.7652699947357178
Epoch 7 over :Attack test accuracy: 0.7575636506080627, Best accuracy : 0.7652699947357178
Epoch 8 over :Attack test accuracy: 0.7541385889053345, Best accuracy : 0.7652699947357178
Epoch 9 over :Attack test accuracy: 0.7501997947692871, Best accuracy : 0.7652699947357178
/home/dc2-user/anaconda3/envs/memberinf_fed/lib/python3.7/site-packages/numpy/core/fromnumeric.py:3335: RuntimeWarning: Mean of empty slice.
  out=out, **kwargs)
/home/dc2-user/anaconda3/envs/memberinf_fed/lib/python3.7/site-packages/numpy/core/_methods.py:161: RuntimeWarning: invalid value encountered in double_scalars
  ret = ret.dtype.type(ret / rcount)
[fed-epoch 4] cid: 2
Using learning rate 0.0001
Epoch 1/15
391/391 [==============================] - 5s 12ms/step - loss: 1.1787 - accuracy: 0.6168 - val_loss: 1.3929 - val_accuracy: 0.5488 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 2/15
391/391 [==============================] - 5s 12ms/step - loss: 0.8798 - accuracy: 0.7194 - val_loss: 1.4423 - val_accuracy: 0.5638 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 3/15
391/391 [==============================] - 5s 12ms/step - loss: 0.6821 - accuracy: 0.7930 - val_loss: 1.5994 - val_accuracy: 0.5567 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 4/15
391/391 [==============================] - 5s 12ms/step - loss: 0.5226 - accuracy: 0.8562 - val_loss: 1.7809 - val_accuracy: 0.5556 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 5/15
391/391 [==============================] - 5s 12ms/step - loss: 0.4237 - accuracy: 0.8924 - val_loss: 1.9694 - val_accuracy: 0.5453 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 6/15
391/391 [==============================] - 5s 12ms/step - loss: 0.3573 - accuracy: 0.9189 - val_loss: 2.1833 - val_accuracy: 0.5408 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 7/15
391/391 [==============================] - 5s 12ms/step - loss: 0.3018 - accuracy: 0.9385 - val_loss: 2.2720 - val_accuracy: 0.5592 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 8/15
391/391 [==============================] - 5s 12ms/step - loss: 0.2724 - accuracy: 0.9507 - val_loss: 2.4283 - val_accuracy: 0.5522 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 9/15
391/391 [==============================] - 5s 12ms/step - loss: 0.2595 - accuracy: 0.9545 - val_loss: 2.5032 - val_accuracy: 0.5467 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 10/15
391/391 [==============================] - 5s 12ms/step - loss: 0.2425 - accuracy: 0.9617 - val_loss: 2.5958 - val_accuracy: 0.5440 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 11/15
391/391 [==============================] - 5s 12ms/step - loss: 0.2485 - accuracy: 0.9585 - val_loss: 2.4680 - val_accuracy: 0.5592 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 12/15
391/391 [==============================] - 5s 12ms/step - loss: 0.2234 - accuracy: 0.9686 - val_loss: 2.5330 - val_accuracy: 0.5661 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 13/15
391/391 [==============================] - 5s 12ms/step - loss: 0.2198 - accuracy: 0.9691 - val_loss: 2.6214 - val_accuracy: 0.5639 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 14/15
391/391 [==============================] - 5s 12ms/step - loss: 0.2113 - accuracy: 0.9718 - val_loss: 2.4843 - val_accuracy: 0.5581 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 15/15
391/391 [==============================] - 5s 12ms/step - loss: 0.2072 - accuracy: 0.9751 - val_loss: 2.6074 - val_accuracy: 0.5558 - lr: 1.0000e-04
[fed-epoch 4] cid: 3
Using learning rate 0.0001
Epoch 1/15
391/391 [==============================] - 5s 12ms/step - loss: 1.1131 - accuracy: 0.6373 - val_loss: 1.3566 - val_accuracy: 0.5673 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 2/15
391/391 [==============================] - 5s 12ms/step - loss: 0.8338 - accuracy: 0.7361 - val_loss: 1.4765 - val_accuracy: 0.5486 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 3/15
391/391 [==============================] - 5s 12ms/step - loss: 0.6454 - accuracy: 0.8063 - val_loss: 1.5395 - val_accuracy: 0.5694 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 4/15
391/391 [==============================] - 5s 12ms/step - loss: 0.5210 - accuracy: 0.8558 - val_loss: 1.7928 - val_accuracy: 0.5490 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 5/15
391/391 [==============================] - 5s 12ms/step - loss: 0.4240 - accuracy: 0.8922 - val_loss: 1.9615 - val_accuracy: 0.5568 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 6/15
391/391 [==============================] - 5s 12ms/step - loss: 0.3497 - accuracy: 0.9211 - val_loss: 2.1268 - val_accuracy: 0.5602 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 7/15
391/391 [==============================] - 4s 11ms/step - loss: 0.3337 - accuracy: 0.9245 - val_loss: 2.1290 - val_accuracy: 0.5547 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 8/15
391/391 [==============================] - 4s 11ms/step - loss: 0.2729 - accuracy: 0.9513 - val_loss: 2.2641 - val_accuracy: 0.5661 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 9/15
391/391 [==============================] - 4s 11ms/step - loss: 0.2719 - accuracy: 0.9510 - val_loss: 2.3709 - val_accuracy: 0.5566 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 10/15
391/391 [==============================] - 4s 11ms/step - loss: 0.2535 - accuracy: 0.9586 - val_loss: 2.4311 - val_accuracy: 0.5611 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 11/15
391/391 [==============================] - 4s 11ms/step - loss: 0.2437 - accuracy: 0.9620 - val_loss: 2.4629 - val_accuracy: 0.5460 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 12/15
391/391 [==============================] - 5s 12ms/step - loss: 0.2333 - accuracy: 0.9631 - val_loss: 2.4364 - val_accuracy: 0.5546 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 13/15
391/391 [==============================] - 5s 12ms/step - loss: 0.2037 - accuracy: 0.9741 - val_loss: 2.5133 - val_accuracy: 0.5586 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 14/15
391/391 [==============================] - 5s 12ms/step - loss: 0.2188 - accuracy: 0.9688 - val_loss: 2.5547 - val_accuracy: 0.5613 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 15/15
391/391 [==============================] - 5s 12ms/step - loss: 0.2171 - accuracy: 0.9714 - val_loss: 2.5699 - val_accuracy: 0.5422 - lr: 1.0000e-04
[fed-epoch 5] cid: 0
Using learning rate 0.0001
Epoch 1/15
391/391 [==============================] - 5s 12ms/step - loss: 1.0455 - accuracy: 0.6594 - val_loss: 1.3663 - val_accuracy: 0.5691 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 2/15
391/391 [==============================] - 5s 12ms/step - loss: 0.7391 - accuracy: 0.7696 - val_loss: 1.5906 - val_accuracy: 0.5619 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 3/15
391/391 [==============================] - 5s 12ms/step - loss: 0.5648 - accuracy: 0.8351 - val_loss: 1.7061 - val_accuracy: 0.5654 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 4/15
391/391 [==============================] - 5s 12ms/step - loss: 0.4240 - accuracy: 0.8922 - val_loss: 1.8964 - val_accuracy: 0.5592 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 5/15
391/391 [==============================] - 5s 12ms/step - loss: 0.3568 - accuracy: 0.9199 - val_loss: 2.0093 - val_accuracy: 0.5636 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 6/15
391/391 [==============================] - 5s 12ms/step - loss: 0.2998 - accuracy: 0.9394 - val_loss: 2.1769 - val_accuracy: 0.5601 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 7/15
391/391 [==============================] - 5s 12ms/step - loss: 0.2648 - accuracy: 0.9564 - val_loss: 2.4395 - val_accuracy: 0.5655 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 8/15
391/391 [==============================] - 5s 12ms/step - loss: 0.2600 - accuracy: 0.9540 - val_loss: 2.4172 - val_accuracy: 0.5565 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 9/15
391/391 [==============================] - 5s 12ms/step - loss: 0.2381 - accuracy: 0.9622 - val_loss: 2.4528 - val_accuracy: 0.5561 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 10/15
391/391 [==============================] - 5s 12ms/step - loss: 0.2408 - accuracy: 0.9622 - val_loss: 2.3841 - val_accuracy: 0.5638 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 11/15
391/391 [==============================] - 5s 12ms/step - loss: 0.2298 - accuracy: 0.9669 - val_loss: 2.4655 - val_accuracy: 0.5696 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 12/15
391/391 [==============================] - 5s 12ms/step - loss: 0.2293 - accuracy: 0.9650 - val_loss: 2.5838 - val_accuracy: 0.5564 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 13/15
391/391 [==============================] - 5s 12ms/step - loss: 0.2040 - accuracy: 0.9734 - val_loss: 2.5582 - val_accuracy: 0.5691 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 14/15
391/391 [==============================] - 5s 12ms/step - loss: 0.2021 - accuracy: 0.9741 - val_loss: 2.6474 - val_accuracy: 0.5545 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 15/15
391/391 [==============================] - 5s 12ms/step - loss: 0.2335 - accuracy: 0.9635 - val_loss: 2.5125 - val_accuracy: 0.5655 - lr: 1.0000e-04
[fed-epoch 5] cid: 1
Using learning rate 0.0001
Epoch 1/15
391/391 [==============================] - 5s 12ms/step - loss: 0.1900 - accuracy: 0.9776 - val_loss: 3.3920 - val_accuracy: 0.5235 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 2/15
391/391 [==============================] - 5s 12ms/step - loss: 0.1566 - accuracy: 0.9902 - val_loss: 3.4673 - val_accuracy: 0.5286 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 3/15
391/391 [==============================] - 5s 12ms/step - loss: 0.1355 - accuracy: 0.9973 - val_loss: 3.6057 - val_accuracy: 0.5372 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 4/15
391/391 [==============================] - 5s 12ms/step - loss: 0.1250 - accuracy: 0.9998 - val_loss: 3.5178 - val_accuracy: 0.5364 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 5/15
391/391 [==============================] - 5s 12ms/step - loss: 0.1716 - accuracy: 0.9834 - val_loss: 3.0131 - val_accuracy: 0.4771 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 6/15
391/391 [==============================] - 5s 12ms/step - loss: 0.2018 - accuracy: 0.9734 - val_loss: 3.2363 - val_accuracy: 0.5246 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 7/15
391/391 [==============================] - 5s 12ms/step - loss: 0.1946 - accuracy: 0.9746 - val_loss: 2.9880 - val_accuracy: 0.5224 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 8/15
391/391 [==============================] - 5s 12ms/step - loss: 0.1706 - accuracy: 0.9842 - val_loss: 3.4066 - val_accuracy: 0.5215 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 9/15
391/391 [==============================] - 5s 12ms/step - loss: 0.1576 - accuracy: 0.9883 - val_loss: 3.4474 - val_accuracy: 0.5291 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 10/15
391/391 [==============================] - 5s 12ms/step - loss: 0.1982 - accuracy: 0.9758 - val_loss: 3.4462 - val_accuracy: 0.5217 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 11/15
391/391 [==============================] - 5s 12ms/step - loss: 0.1523 - accuracy: 0.9896 - val_loss: 3.4863 - val_accuracy: 0.5119 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 12/15
391/391 [==============================] - 5s 12ms/step - loss: 0.1902 - accuracy: 0.9774 - val_loss: 3.3646 - val_accuracy: 0.5166 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 13/15
391/391 [==============================] - 5s 12ms/step - loss: 0.1865 - accuracy: 0.9784 - val_loss: 3.3829 - val_accuracy: 0.5330 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 14/15
391/391 [==============================] - 5s 12ms/step - loss: 0.1796 - accuracy: 0.9804 - val_loss: 3.1634 - val_accuracy: 0.5301 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 15/15
391/391 [==============================] - 5s 12ms/step - loss: 0.1702 - accuracy: 0.9840 - val_loss: 3.2499 - val_accuracy: 0.5311 - lr: 1.0000e-04
isolating attack on cid: 1 in fed-epoch: 5
Target model test accuracy 0.5488
Epoch 0 over :Attack test accuracy: 0.7452334761619568, Best accuracy : 0.7452334761619568
Epoch 1 over :Attack test accuracy: 0.7305628657341003, Best accuracy : 0.7452334761619568
Epoch 2 over :Attack test accuracy: 0.7583628296852112, Best accuracy : 0.7583628296852112
Epoch 3 over :Attack test accuracy: 0.7624158263206482, Best accuracy : 0.7624158263206482
Epoch 4 over :Attack test accuracy: 0.7680100202560425, Best accuracy : 0.7680100202560425
Epoch 5 over :Attack test accuracy: 0.7458614110946655, Best accuracy : 0.7680100202560425
Epoch 6 over :Attack test accuracy: 0.7697796821594238, Best accuracy : 0.7697796821594238
Epoch 7 over :Attack test accuracy: 0.7638428807258606, Best accuracy : 0.7697796821594238
Epoch 8 over :Attack test accuracy: 0.7636145949363708, Best accuracy : 0.7697796821594238
Epoch 9 over :Attack test accuracy: 0.7686379551887512, Best accuracy : 0.7697796821594238
/home/dc2-user/anaconda3/envs/memberinf_fed/lib/python3.7/site-packages/numpy/core/fromnumeric.py:3335: RuntimeWarning: Mean of empty slice.
  out=out, **kwargs)
/home/dc2-user/anaconda3/envs/memberinf_fed/lib/python3.7/site-packages/numpy/core/_methods.py:161: RuntimeWarning: invalid value encountered in double_scalars
  ret = ret.dtype.type(ret / rcount)
[fed-epoch 5] cid: 2
Using learning rate 0.0001
Epoch 1/15
391/391 [==============================] - 5s 12ms/step - loss: 1.1390 - accuracy: 0.6343 - val_loss: 1.3396 - val_accuracy: 0.5595 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 2/15
391/391 [==============================] - 5s 12ms/step - loss: 0.7978 - accuracy: 0.7496 - val_loss: 1.4658 - val_accuracy: 0.5673 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 3/15
391/391 [==============================] - 5s 12ms/step - loss: 0.5789 - accuracy: 0.8327 - val_loss: 1.6503 - val_accuracy: 0.5669 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 4/15
391/391 [==============================] - 5s 12ms/step - loss: 0.4326 - accuracy: 0.8890 - val_loss: 1.8909 - val_accuracy: 0.5645 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 5/15
391/391 [==============================] - 5s 12ms/step - loss: 0.3477 - accuracy: 0.9228 - val_loss: 2.0793 - val_accuracy: 0.5540 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 6/15
391/391 [==============================] - 5s 12ms/step - loss: 0.3025 - accuracy: 0.9376 - val_loss: 2.2410 - val_accuracy: 0.5571 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 7/15
391/391 [==============================] - 5s 12ms/step - loss: 0.2594 - accuracy: 0.9546 - val_loss: 2.3640 - val_accuracy: 0.5617 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 8/15
391/391 [==============================] - 5s 12ms/step - loss: 0.2601 - accuracy: 0.9546 - val_loss: 2.5159 - val_accuracy: 0.5627 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 9/15
391/391 [==============================] - 5s 12ms/step - loss: 0.2208 - accuracy: 0.9679 - val_loss: 2.4809 - val_accuracy: 0.5559 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 10/15
391/391 [==============================] - 5s 12ms/step - loss: 0.2273 - accuracy: 0.9689 - val_loss: 2.5827 - val_accuracy: 0.5674 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 11/15
391/391 [==============================] - 5s 12ms/step - loss: 0.2129 - accuracy: 0.9727 - val_loss: 2.5368 - val_accuracy: 0.5504 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 12/15
391/391 [==============================] - 5s 12ms/step - loss: 0.2178 - accuracy: 0.9706 - val_loss: 2.5926 - val_accuracy: 0.5698 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 13/15
391/391 [==============================] - 5s 12ms/step - loss: 0.2074 - accuracy: 0.9744 - val_loss: 2.6353 - val_accuracy: 0.5610 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 14/15
391/391 [==============================] - 5s 12ms/step - loss: 0.2194 - accuracy: 0.9667 - val_loss: 2.5169 - val_accuracy: 0.5545 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 15/15
391/391 [==============================] - 5s 12ms/step - loss: 0.1995 - accuracy: 0.9750 - val_loss: 2.7642 - val_accuracy: 0.5615 - lr: 1.0000e-04
[fed-epoch 5] cid: 3
Using learning rate 0.0001
Epoch 1/15
391/391 [==============================] - 5s 12ms/step - loss: 1.0375 - accuracy: 0.6650 - val_loss: 1.3944 - val_accuracy: 0.5697 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 2/15
391/391 [==============================] - 5s 12ms/step - loss: 0.7425 - accuracy: 0.7768 - val_loss: 1.4912 - val_accuracy: 0.5719 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 3/15
391/391 [==============================] - 5s 12ms/step - loss: 0.5447 - accuracy: 0.8469 - val_loss: 1.6558 - val_accuracy: 0.5679 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 4/15
391/391 [==============================] - 5s 12ms/step - loss: 0.4128 - accuracy: 0.8978 - val_loss: 1.9574 - val_accuracy: 0.5645 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 5/15
391/391 [==============================] - 5s 12ms/step - loss: 0.3642 - accuracy: 0.9174 - val_loss: 2.0593 - val_accuracy: 0.5624 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 6/15
391/391 [==============================] - 5s 12ms/step - loss: 0.2753 - accuracy: 0.9506 - val_loss: 2.2451 - val_accuracy: 0.5591 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 7/15
391/391 [==============================] - 5s 12ms/step - loss: 0.2806 - accuracy: 0.9467 - val_loss: 2.3179 - val_accuracy: 0.5583 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 8/15
391/391 [==============================] - 5s 12ms/step - loss: 0.2384 - accuracy: 0.9641 - val_loss: 2.4076 - val_accuracy: 0.5594 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 9/15
391/391 [==============================] - 5s 12ms/step - loss: 0.2489 - accuracy: 0.9588 - val_loss: 2.3253 - val_accuracy: 0.5541 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 10/15
391/391 [==============================] - 5s 12ms/step - loss: 0.2312 - accuracy: 0.9654 - val_loss: 2.4502 - val_accuracy: 0.5670 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 11/15
391/391 [==============================] - 5s 12ms/step - loss: 0.2142 - accuracy: 0.9717 - val_loss: 2.5373 - val_accuracy: 0.5533 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 12/15
391/391 [==============================] - 5s 12ms/step - loss: 0.2044 - accuracy: 0.9746 - val_loss: 2.4735 - val_accuracy: 0.5728 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 13/15
391/391 [==============================] - 5s 12ms/step - loss: 0.2214 - accuracy: 0.9680 - val_loss: 2.5243 - val_accuracy: 0.5628 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 14/15
391/391 [==============================] - 5s 12ms/step - loss: 0.2014 - accuracy: 0.9764 - val_loss: 2.5762 - val_accuracy: 0.5553 - lr: 1.0000e-04
Using learning rate 0.0001
Epoch 15/15
391/391 [==============================] - 5s 12ms/step - loss: 0.1870 - accuracy: 0.9816 - val_loss: 2.5278 - val_accuracy: 0.5659 - lr: 1.0000e-04
